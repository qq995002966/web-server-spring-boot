require(["frontmain"],function(){require(["jquery","layer","perfect-scrollbar.jquery.min","base","front","store.min","app/outside"],function(){store=require("store.min"),F_Article_Entrance._init()})});var F_Article_Entrance={_init:function(){B_Login._check(),S_HeadFoot._getHead(),S_HeadFoot._htmlPaper();var t=B_Common._getUrl("controller"),e=B_Common._getUrl("query");switch(t){case"article":F_Article_List._init(e),B_AD._ad("ad_1"),B_AD._ad("ad_2");break;case"detail":F_Article_Detail._init(e)}}},F_Article_Detail={_init:function(t){t.t?(t.t=B_Common._decodeUrl(t.t),F_Detail_Info._getData(t.t),F_Article_Info._getData("recent",1,6),F_Detail_Relation._getData(t.t),F_Article_Common._cache.selectedClassifyBig="人物",F_Article_Info._getData("recommend_classify",1,6),F_Detail_Relation._clickTab()):$("#bs_detail").html("")}},F_Detail_Info={_htmlDetail:function(data){var str="";data.image_list&&data.image_list.length>0&&B_Common._imgBuff(data.image_list);var content=B_Common._htmlUnicodeTagScriptEscape(data.raw_html_content);try{content=eval("'"+content+"'")}catch(t){content=unescape(content.replace(/\u/g,"%u"))}content=B_Common._htmlspecialchars_decode(content),content=B_Common._htmlTagScriptEscape(content),str+='<div class="title">',str+="<h3>"+data.title+"</h3>",str+="<span>"+S_Article._getSource(data.source)+"</span>",str+="<span>"+data.post_date+"</span>",str+='<a href="'+data.url+'" target="_blank">查看原文</a>',str+="</div>",str+=content,setTimeout(function(){$("#bs_detail").html(str)},200)},_getData:function(t){var e=$("#bs_detail"),a={};a.title=t,a=B_Common._postData(a),B_Port._ajax("articleDetail","get",!0,a,function(){e.html(B_Pre._loading())},function(){e.html("")},function(t,e){t.data&&t.data.list&&F_Detail_Info._htmlDetail(t.data.list[0].source)},function(t,a,i){e.html(B_Pre._empty(a))})}},F_Article_List={_init:function(t){t.t||(t.t="top"),F_Article_Common._cache={condition:[]};var e="";switch(t.t){case"topic":$(".daily-news .left").hide(),$(".daily-news .right").css({"margin-left":0}),t.n&&$("#bs_title").html(B_Common._decodeUrl(t.n)),t.d&&(F_Article_Common._cache.condition.topic_id=t.d),t.b&&(F_Article_Common._cache.condition.data_date_start=t.b),t.e&&(F_Article_Common._cache.condition.data_date_end=t.e),e="list_topic";break;case"classify":t.m&&(t.m=B_Common._decodeUrl(t.m),F_Article_Common._cache.selectedClassifyBig=t.m,t.s&&(t.s=B_Common._decodeUrl(t.s),F_Article_Common._cache.selectedClassifySmall=t.s)),e="list_classify";break;case"top":F_Article_Common._cache.selectedClassifyBig="头条",e="list_top";break;case"hot":F_Article_Common._cache.selectedClassifyBig="热门",e="list_recent"}F_Article_Info._getData(e,1,20),F_Article_Common._cache.classify=S_Article._getClassify(),F_Article_Common._htmlMenuFirst(),F_Article_trend._getData(),F_Article_Info._getData("top",1,9),F_Article_Keypoint._getData(),F_Article_HotWord._getData(),setTimeout(function(){F_Article_Info._getData("recent",1,6)},300)}},F_Article_Common={_cache:{condition:{}},_htmlMenuFirst:function(){var t=["头条","热门","公司","前沿","研发","行业","电竞","人物"],e=F_Article_Common._cache.classify,a="",i="";F_Article_Common._cache.selectedClassifyBig||(F_Article_Common._cache.selectedClassifyBig="头条");for(var l=0;l<t.length;l++){switch(t[l]){case"头条":i="h_qkTb13";break;case"热门":i="h_qkTb12";break;default:i=e[t[l]]?e[t[l]].img.styleClass:""}a+='<li data-i="'+t[l]+'"',F_Article_Common._cache.selectedClassifyBig&&F_Article_Common._cache.selectedClassifyBig==t[l]?(a+=' class="selected"><i class="'+i+' b_img"></i>'+t[l]+'<i class="triangle-icon tf-icon"></i></li>',F_Article_Common._htmlMenuSecond(t[l])):a+='"><i class="'+i+' b_img"></i>'+t[l]+"</li>"}$(".daily-news .left").html(a),F_Article_Common._clickBig()},_htmlMenuSecond:function(t){var e=F_Article_Common._cache.classify,a=$(".daily-news .right .tab-change");if(e[t]&&e[t].sub&&e[t].sub.length>1){e=e[t].sub;for(var i="",l=!1,c=0;c<e.length;c++)F_Article_Common._cache.selectedClassifySmall&&F_Article_Common._cache.selectedClassifySmall==e[c].sub_class?(l=!0,i+='<span class="selected">'+e[c].sub_class+"</span>"):i+="<span>"+e[c].sub_class+"</span>";i=l?"<span>全部</span>"+i:'<span class="selected">全部</span>'+i,a.html(i),F_Article_Common._clickSmall(),a.show()}else a.hide()},_clickBig:function(){$(".daily-news .left li").each(function(t){$(this).click(function(){if(!$(this).hasClass("selected")){$(this).addClass("selected").siblings("li").removeClass("selected"),$(this).siblings("li").find(".triangle-icon").remove(),$(this).append('<i class="triangle-icon tf-icon"></i>');var t=$(this).attr("data-i");switch(F_Article_Common._htmlMenuSecond(t),F_Article_Common._cache.selectedClassifyBig=t,F_Article_Common._cache.selectedClassifySmall="",t){case"头条":F_Article_Info._getData("list_top",1,20);break;case"热门":F_Article_Info._getData("list_recent",1,20);break;default:F_Article_Common._cache.selectedClassifyBig=t,F_Article_Info._getData("list_classify",1,20)}}})})},_clickSmall:function(){$(".daily-news .right .tab-change span").each(function(t){$(this).click(function(){if(!$(this).hasClass("selected")){switch($(this).addClass("selected").siblings("span").removeClass("selected"),t+""){case"0":F_Article_Common._cache.selectedClassifySmall="";break;default:F_Article_Common._cache.selectedClassifySmall=$(this).html()}F_Article_Info._getData("list_classify",1,20)}})})},_clickMore:function(){$("#bs_article_more").click(function(){var t=$(this).attr("data-p"),e=$(this).attr("data-t");t=parseInt(t)+1,$(this).attr("data-p",t),F_Article_Info._getData(e,t,20,!0)})}},F_Article_Info={_getCondition:function(t,e,a,i){var l={};switch(a=a||B_Page._size,t){case"top":case"list_top":l.data_date_start=B_Date._getDiffDate(null,-1),l.data_date_end=B_Date._getDiffDate(null,0),l.order_by_field="post_date,score",l.order_type="desc,desc",l.need_preview="1",l.index=(e-1)*a,l.limit=a;break;case"recent":case"list_recent":l.data_date_start=B_Date._getDiffDate(null,-7),l.data_date_end=B_Date._getDiffDate(null,0),l.order_by_field="score",l.order_type="desc",l.need_preview="1",l.index=(e-1)*a,l.limit=a;break;case"relation":l.ignore_bad="1",l.title_only="1",l.need_preview="1",l.keyword=i.keyword,l.index=(e-1)*a,l.limit=a;break;case"list_classify":case"recommend_classify":l.main_class=F_Article_Common._cache.selectedClassifyBig,F_Article_Common._cache.selectedClassifySmall&&(l.sub_class=F_Article_Common._cache.selectedClassifySmall),l.need_preview="1",l.index=(e-1)*a,l.limit=a;break;default:F_Article_Common._cache.condition&&(l=F_Article_Common._cache.condition),l.need_preview="1",l.index=(e-1)*a,l.limit=a}return B_Common._postData(l)},_htmlTop:function(t){for(var e=[],a="<ul>",i=0;i<t.length;i++)t[i].source.main_class||(t[i].source.main_class="其他"),e=F_Article_Common._cache.classify[t[i].source.main_class]?F_Article_Common._cache.classify[t[i].source.main_class]:F_Article_Common._cache.classify["其他"],a+="<li>",a+='<a href="'+S_Article._detailUrl(t[i].id)+'" target="_blank">',a+=S_Article._previewImg(t[i].source.preview_img,t[i].source.source),a+="</a>",a+='<div class="des">',a+='<p><a href="'+S_Article._detailUrl(t[i].id)+'" target="_blank" title="'+t[i].source.title+'">'+t[i].source.title+"</a></p>",a+='<i class="tf-article-type-icon b_img '+e.img.styleClass+'"></i>',a+="<span>"+t[i].source.main_class+"</span>",a+="<span>"+S_Article._getSource(t[i].source.source)+"</span>",a+="<span>"+t[i].source.post_date+"</span>",a+="</div>",a+="</li>";return a+="</ul>"},_htmlRelation:function(t){if(t.length>0){for(var e=[],a='<ul class="list">',i=0;i<t.length;i++)t[i].source.main_class||(t[i].source.main_class="其他"),e=F_Article_Common._cache.classify[t[i].source.main_class]?F_Article_Common._cache.classify[t[i].source.main_class]:F_Article_Common._cache.classify["其他"],a+="<li>",a+='<p><a href="'+S_Article._detailUrl(t[i].id)+'" target="_blank" title="'+t[i].source.title+'">'+t[i].source.title+"</a></p>",a+="<div>",a+='<i class="b_img '+e.img.styleClass+'"></i>',a+="<span>"+t[i].source.main_class+"</span>",a+="<span>"+S_Article._getSource(t[i].source.source)+"</span>",a+='<span class="date">'+t[i].source.post_date+"</span>",a+="</div>",a+="</li>";a+="</ul>"}else a+=B_Pre._empty("暂无数据");return a},_htmlRecent:function(t){var e="";if(t.length>0){e+='<ul class="list">';for(var a=0;a<t.length&&!(a>5);a++)e+="<li>",e+='<a href="'+S_Article._detailUrl(t[a].id)+'" target="_blank">',e+=S_Article._previewImg(t[a].source.preview_img,t[a].source.source),e+="</a>",e+='<p><a href="'+S_Article._detailUrl(t[a].id)+'" target="_blank" title="'+t[a].source.title+'">'+t[a].source.title+"</a></p>",e+="</li>";e+="</ul>"}else e+=B_Pre._empty("暂无数据");return e},_htmlList:function(t,e,a,i){var l="";if(i.total){for(var c=[],_=i.list,s=0;s<_.length;s++)_[s].source.main_class||(_[s].source.main_class="其他"),c=F_Article_Common._cache.classify[_[s].source.main_class]?F_Article_Common._cache.classify[_[s].source.main_class]:F_Article_Common._cache.classify["其他"],l+="<li>",l+='<a href="'+S_Article._detailUrl(_[s].id)+'" target="_blank">',l+=S_Article._previewImg(_[s].source.preview_img,_[s].source.source),l+="</a>",l+='<div class="des">',l+='<h3><a href="'+S_Article._detailUrl(_[s].id)+'" target="_blank" title="'+_[s].source.title+'">'+_[s].source.title+"</a></h3>",l+="<p>"+_[s].source.content+"</p>",l+="<div>",c&&c.img&&(l+='<i class="'+c.img.styleClass+' b_img"></i>'),l+="<span>"+_[s].source.main_class+"</span>",l+="<span>"+S_Article._getSource(_[s].source.source)+"</span>",l+='<span class="date">'+_[s].source.post_date+"</span>",l+="</div>",l+="</div>",l+="</li>";parseInt(i.total)>(e-1)*a+a?l+='<span class="show-all-remind" data-t="'+t+'" data-p="'+e+'" id="bs_article_more" style="cursor: pointer">点击查看更多</span>':l+='<span class="show-all-remind">已经是全部文章</span>'}else l=B_Pre._empty("暂无数据");return l},_htmlRecommend:function(t){for(var e="",a=0;a<t.length&&!(a>5);a++)e+="<li>",e+='<a href="'+S_Article._detailUrl(t[a].id)+'" target="_blank" title="'+t[a].source.title+'">'+t[a].source.title+"</a>",e+="</li>";return e},_getData:function(t,e,a,i){var l="",c=!0;switch(t){case"top":l=$("#bs_top_list");break;case"recent":l=$("#bs_recent_list");break;case"relation":l=$("#bs_relation_list");break;case"list_recent":case"list_top":case"list_topic":case"list_classify":c=!i,l=$("#bs_article_list");break;case"recommend_classify":l=$("#bs_recommend_list")}var _=F_Article_Info._getCondition(t,e,a,i);B_Port._ajax("articleList","get",!0,_,function(){c?l.html(B_Pre._loading()):$("#bs_article_more").unbind("click").html("加载中...")},function(){c?l.html(""):$("#bs_article_more").remove()},function(i,c){if(i.data&&i.data.list)switch(t){case"top":l.html(F_Article_Info._htmlTop(i.data.list)),M_Outside._clickScroll($("#bs_top_choose .pre-icon"),$("#bs_top_choose .next-icon"),$("#bs_top_list ul"),"",232,3,3,"selected-btn");break;case"recent":l.html(F_Article_Info._htmlRecent(i.data.list));break;case"relation":l.html(F_Article_Info._htmlRelation(i.data.list)),l.perfectScrollbar();break;case"list_recent":case"list_top":case"list_topic":case"list_classify":l.append(F_Article_Info._htmlList(t,e,a,i.data)),F_Article_Common._clickMore();break;case"recommend_classify":l.append(F_Article_Info._htmlRecommend(i.data.list))}},function(t,e,a){l.html(B_Pre._empty(e))})}},F_Article_Keypoint={_clickChoose:function(){$("#bs_keypoint span").each(function(){$(this).click(function(){var t=$(this).attr("data-i"),e=$(this).html();B_Jump._go("openUrl",B_Jump._getUrl("search")+"?t=t&d="+B_Common._encodeUrl(t)+"&k="+B_Common._encodeUrl(e))})})},_getData:function(){var t=$("#bs_keypoint"),e={};e.data_date_start=B_Date._getDiffDate(null,-30),e.data_date_end=B_Date._getDiffDate(null,0),e=B_Common._postData(e),B_Port._ajax("industryArticleTopic","get",!0,e,function(){t.html(B_Pre._loading())},function(){t.html("")},function(e,a){e&&e.article_topic_distri&&(t.html(F_Article_Keypoint._htmlList(e.article_topic_distri)),F_Article_Keypoint._clickChoose())},function(e,a,i){t.html(B_Pre._empty(a))})},_htmlList:function(t){for(var e="",a=0;a<t.length;a++)e+='<span data-i="'+t[a].topic_id+'">'+t[a].topic_keywords+"</span>";return e}},F_Article_HotWord={_getData:function(){var t=$(".hot-word-rank"),e=$(".relation-word-rank");B_Port._ajax("industryArticleHotWords","get",!0,null,function(){t.html(B_Pre._loading()),e.html(B_Pre._loading())},function(){t.html(""),e.html("")},function(e,a){if(e&&e.article_hot_word_distri){F_Article_Common._cache.hotWord=e.article_hot_word_distri;for(var i=0,l=e.article_hot_word_distri.length,c=0;c<l;c++)i+=parseInt(e.article_hot_word_distri[c].hot_score);t.html(F_Article_HotWord._htmlTableList(e.article_hot_word_distri,i)),$("#bs_keypoint_scroll").perfectScrollbar(),F_Article_HotWord._htmlRelationChoose(0,l)}},function(a,i,l){t.html(B_Pre._empty(i)),e.html(B_Pre._empty(i))})},_clickRelation:function(){var t=$("#bs_relation_rank");$("#bs_relation_next").click(function(){var e=t.attr("data-i"),a=t.attr("data-a");e=parseInt(e),a=parseInt(a),e<a&&(F_Article_HotWord._htmlRelationChoose(e,a),t.attr("data-i",e+1),t.html("Top"+(e+1)))}),$("#bs_relation_pre").click(function(){var e=t.attr("data-i"),a=t.attr("data-a");e=parseInt(e),a=parseInt(a),e>1&&(F_Article_HotWord._htmlRelationChoose(e-2,a),t.attr("data-i",e-1),t.html("Top"+(e-1)))})},_htmlRelationChoose:function(t,e){parseInt(e)>10&&(e=10);var a="";if(F_Article_Common._cache.hotWord&&F_Article_Common._cache.hotWord[t]){var i=F_Article_Common._cache.hotWord[t];a+='<div class="control">',a+='<i class="tf-icon control-icon prev-icon" id="bs_relation_pre"></i>',a+='<span class="rank" id="bs_relation_rank" data-i="'+(t+1)+'" data-a="'+e+'">Top'+(t+1)+"</span>",a+='<i class="tf-icon control-icon next-icon" id="bs_relation_next"></i>',a+='<span class="name">'+i.keyword+"</span>",a+="</div>",a+='<div class="re-hotword">';for(var l=0;l<i.related_word_list.length&&!(l>=10);l++)a+="<span>"+i.related_word_list[l]+"</span>";a+="</div>",a+='<div id="bs_relation_list" style="position: relative;height: 340px; overflow: hidden;"></div>',$(".relation-word-rank").html(a),F_Article_HotWord._clickRelation(),F_Article_Info._getData("relation",1,50,{keyword:i.keyword})}},_htmlTableList:function(t,e){var a="<table><thead><th>排名</th><th>媒体热词</th><th>热词指数</th></thead></table>";a+='<div class="table-overflow-wrap" id="bs_keypoint_scroll" style="position: relative;"><table><tbody>';for(var i=0,l=0;l<t.length;l++)i=(parseInt(t[l].hot_score)/parseInt(e)*100).toFixed(1),i*=10,i=i>100?100:i,a+="<tr onclick=\"B_Jump._go('openUrl','"+B_Jump._getUrl("search")+"?t=k&k="+B_Common._encodeUrl(t[l].keyword)+"')\">",a+="<td>"+(l+1)+"</td>",a+='<td class="word">'+t[l].keyword+"</td>",a+='<td class="rate"><div class="rate-wrap"><span class="rate-percent" style="width: '+i+'%"></span></div></td>',a+="</tr>";return a+="<tbody></table></div>"}},F_Article_trend={_getData:function(){var t={};t.scope="realtime",t=B_Common._postData(t),B_Port._ajax("industryGeneral","get",!0,t,null,null,function(t,e){t&&($("#bs_today_count").html(t.title_num_today_total),$("#bs_channel_count").html(t.channel_num_today_total),$("#bs_article_count").html(t.article_num_today_total))},null)}},F_Detail_Relation={_clickTab:function(){$("#bs_tab_classify li").each(function(){$(this).click(function(){$(this).hasClass("selected")||($(this).addClass("selected").siblings("li").removeClass("selected"),F_Article_Common._cache.selectedClassifyBig=$(this).html(),F_Article_Info._getData("recommend_classify",1,6))})})},_getData:function(t){var e=$("#bs_relation_detail_list"),a={};a.title=t,a=B_Common._postData(a),B_Port._ajax("articleRelation","get",!0,a,function(){e.html(B_Pre._loading())},function(){e.html("")},function(t,a){t.data&&t.data.list&&e.html(F_Article_Info._htmlRecent(t.data.list))},function(t,a,i){e.html(B_Pre._empty(a))})}};