var M_Inside_Chart={_chartPage:function(a,t){M_Inside_Chart._chartData(20,t,M_Init._dataCache[t],a)},_chartData:function(a,t,e,i){var s={color:["#3daae3","#2ed383","#8b5c9b","#f3d049","#476cd0","#3fa553","#524a89","#ec644c"],tooltip:{trigger:"item"},legend:[],legendSelectMode:!1,xAxis:[],yAxis:[{splitLine:{lineStyle:{color:"#EEEEEE"}},type:"value",axisLine:{show:!1},axisTick:{show:!1},axisLabel:{textStyle:{color:"#333333",fontSize:"11px"}},data:[]}],series:[],xType:"category",xAxisLabel:{textStyle:{color:"#333333",fontSize:"11px"}}};switch(a+""){case"2":case"20":if(s.xType="value",s.tooltip.trigger="axis",e.tooltip){for(var n="",l=0;l<e.tooltip.num;l++)n+='<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:'+s.color[l]+'"></span>{b}: {c'+l+"}"+e.tooltip.unit+"<br />";s.tooltip.formatter=n}var o=M_Inside_Chart._chartXAxisReplace(e.x_axis),c=e.x_axis.length;if(c>10){M_Init._dataCache[t]=e,i||(i=1);var r=B_Page._size*(i-1);o=o.slice(r,r+B_Page._size),$("#"+t).html('<div class="area-page-list" id="bs_chart_'+t+'"></div><ul class="tg-page-list" id="bs_page_'+t+'"></ul>'),$("#bs_page_"+t).html(B_Page._show({total:c,page:i,dom:t},"simple")),B_Page._click(i,function(a,t){M_Inside_Chart._chartPage(a,t)},t),t="bs_chart_"+t}s.yAxis[0].type="category",s.yAxis[0].data=o,s.yAxis[0].inverse=!0;var _=e.y_axis,d=_.length;d>1&&(s.tooltip.axisPointerType="shadow");for(var l=0;l<d;l++){d>1&&s.legend.push(_[l].name),a+""=="2"&&s.legend.push(_[l].name);var h=_[l].data;c>10&&(h=h.slice(r,r+B_Page._size));for(var p=0;p<h.length;p++)h[p]=parseFloat(h[p]);s.series.push({name:_[l].name,type:"bar",barMaxWidth:15,data:h,itemStyle:{normal:{barBorderRadius:5}}})}e.yFormat&&(s.xAxisLabel.formatter="{value}"+e.yFormat);break;case"4":case"40":if(s.yAxis[0].type="value",s.xType="category",s.legendSelectMode=!!e.legendSelectMode&&e.legendSelectMode,!s.legendSelectMode&&e.tooltip){for(var n="",l=0;l<e.tooltip.num;l++)n+='<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:'+s.color[l]+'"></span>{b}: {c'+l+"}"+e.tooltip.unit+"<br />";s.tooltip.formatter=n}s.tooltip.trigger="axis",s.xAxis=M_Inside_Chart._chartXAxisReplace(e.x_axis);var _=e.y_axis,c=_.length;c>1&&(s.tooltip.axisPointerType="shadow");for(var l=0;l<c;l++){c>1&&s.legend.push(_[l].name),a+""=="4"&&s.legend.push(_[l].name);for(var p=0;p<_[l].data.length;p++)_[l].data[p]=parseFloat(_[l].data[p]);s.series.push({name:_[l].name,type:"bar",barMaxWidth:15,data:_[l].data,itemStyle:{normal:{barBorderRadius:5}}})}e.yFormat&&(s.yAxis[0].axisLabel.formatter="{value}"+e.yFormat);break;case"5":case"50":if(s.xType="category",s.tooltip.trigger="axis",s.legendSelectMode=!!e.legendSelectMode&&e.legendSelectMode,!s.legendSelectMode&&e.tooltip){var n="";switch(e.tooltip.type){case"simple":for(var l=0;l<e.tooltip.num;l++)n+='<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:'+s.color[l]+'"></span>{b}: {c'+l+"}"+e.tooltip.unit+"<br />";break;case"diff":n="{b}<br />";for(var l=0;l<e.tooltip.num;l++)n+='<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:'+s.color[l]+'"></span>{a'+l+"}: {c"+l+"}"+e.tooltip.unit[l]+"<br />";break;default:n="{b}<br />";for(var l=0;l<e.tooltip.num;l++)n+='<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:'+s.color[l]+'"></span>{a'+l+"}: {c"+l+"}"+e.tooltip.unit+"<br />"}s.tooltip.formatter=n}s.xAxis=M_Inside_Chart._chartXAxisReplace(e.x_axis),e.xFormatDate&&(s.xAxisLabel.formatter=function(a,t){var e=new Date(a);return[e.getMonth()+1,e.getDate()].join("/")});for(var _=e.y_axis,c=_.length,l=0;l<c;l++){c>1&&s.legend.push(_[l].name);for(var p=0;p<_[l].data.length;p++)_[l].data[p]=parseFloat(_[l].data[p]);switch(a+""){case"50":e.yDouble?"bar"==_[l].type?s.series.push({name:_[l].name,type:_[l].type,yAxisIndex:l,barMaxWidth:15,data:_[l].data,itemStyle:{normal:{barBorderRadius:5}}}):e.areaStyle&&"no"==e.areaStyle?s.series.push({name:_[l].name,type:_[l].type,yAxisIndex:l,data:_[l].data}):s.series.push({name:_[l].name,type:_[l].type,yAxisIndex:l,areaStyle:{normal:{opacity:.05}},data:_[l].data}):e.areaStyle&&"no"==e.areaStyle?s.series.push({name:_[l].name,type:"line",data:_[l].data}):s.series.push({name:_[l].name,type:"line",areaStyle:{normal:{opacity:.05}},data:_[l].data});break;default:s.series.push({name:_[l].name,type:"line",stack:"总量",areaStyle:{normal:{}},data:_[l].data})}}e.yDouble?(s.yAxis[1]={splitLine:{lineStyle:{color:"#EEEEEE"}},type:"value",axisLine:{show:!1},axisTick:{show:!1},axisLabel:{textStyle:{color:"#333333",fontSize:"11px"}},data:[]},s.yAxis[1].splitLine={show:!1},s.yAxis[0].axisLabel.formatter="{value}"+e.yDoubleLabel[0],s.yAxis[1].axisLabel.formatter="{value}"+e.yDoubleLabel[1]):e.yFormat&&(s.yAxis[0].axisLabel.formatter="{value}"+e.yFormat);break;case"60":e.color&&(s.color=e.color),s.tooltip={trigger:"axis"},s.radar=[{indicator:e.indicator,shape:"circle",radius:100,splitArea:{areaStyle:{color:["#ffffff","#ffffff"]}},splitNumber:2}],s.series=[{type:"radar",tooltip:null,data:[]}];var l=0;$.each(e.data,function(a,t){switch(s.legend.push(a),l){case 0:s.series[0].data.push({value:t,name:a,symbolSize:0,areaStyle:{normal:{color:s.color[0],opacity:.8}},lineStyle:{normal:{width:2,color:s.color[1],opacity:.4}}});break;default:s.series[0].data.push({value:t,name:a,symbolSize:0,areaStyle:{normal:{color:s.color[0]}},lineStyle:{normal:{width:0}}})}l++}),l<2&&(s.legend=[])}M_Inside_Chart._drawChart(a,t,s)},_chartXAxisReplace:function(a){for(var t=0;t<a.length;t++)a[t]=a[t].replace("&gt;",">"),a[t]=a[t].replace("&lt;","<");return a},_drawChart:function(a,t,e){var i={},s=[];if(e.legend)for(var n=0;n<e.legend.length;n++)s.push({name:e.legend[n],icon:"roundRect"});switch(i.color=e.color,i.tooltip=e.tooltip,i.legend={left:"right",data:s,selectedMode:e.legendSelectMode},a+""){case"20":i.grid={left:"30",right:"30",bottom:0,top:"2%",containLabel:!0};break;case"60":i.radar=e.radar;break;default:i.grid={left:"30",right:"30",bottom:0,top:"10%",containLabel:!0}}a+""!="1"&&a+""!="60"&&(i.xAxis=[{splitLine:{lineStyle:{color:"#EEEEEE"}},type:e.xType,data:e.xAxis,axisLine:{show:!1},axisTick:{show:!1},axisLabel:e.xAxisLabel}],i.yAxis=e.yAxis),i.series=e.series,B_Chart._getEChart("line",t,i)}},M_Operate={_searchPop:function(){B_Format._arrowOpenClose("#bs_btn_self",".auto-search-pop","operateSearch")},_getTag:function(a){var t="";switch(a){case"helper":case"player":t=$(".auto-search-pop");break;default:t=$("#bs_content_tag")}var e={};e.service_id=3,e.game_id=M_Init._gameId,e=B_Common._postData(e),B_Port._ajax(M_Init._api.innerSearchMeta,"get",!0,e,function(){t.html("")},function(){},function(e,i){if(e&&e.length>0){switch(a){case"helper":case"player":M_Operate._htmlSearch(e[0],a)}switch(a){case"helper":break;case"player":for(var s=0;s<e[0].groupTitle.length;s++)if(""!=e[0].groupTitle[s]){M_Init._dataCache.tabName=e[0].groupTitle[s];break}M_Init._dataCache.tagsData=e,F_Player_Info._getCharacterTag();break;default:M_Operate._formatTag(t,e)}}},function(a,e,i){t.html(B_Pre._empty(e))})},_formatTag:function(a,t){M_Init._dataCache.tagsList={};var e=!!(t[0].primary&&t[0].primary.length>0);$.each(t[0].group,function(a,i){M_Init._dataCache.tagsList[a]=e?t[0].primary.concat(i):i}),a.html(M_Operate._htmlTag(t[0].groupTitle)),M_Operate._getDetail(1),a.find("span").each(function(){$(this).click(function(){$(this).hasClass("selected")||($(this).addClass("selected").siblings().removeClass("selected"),M_Init._dataCache.tabName=$(this).html(),$("#bs_content_list .tg-table thead").html(""),M_Operate._getDetail(1))})})},_btnSearch:function(a){switch(a){case"helper":M_Operate._getSearchTag(),M_Init._operateFrom="helper",B_Jump._go("base",B_Jump._getUrl("operatePlayer"));break;case"player":$("#bs_number").html("0"),$(".auto-search-pop").hide(),$("#bs_main_content").html(""),F_Player_Info._getCharacterTag()}},_htmlSearch:function(a,t){var e="";M_Init._dataCache.tagsList={},M_Init._dataCache.tags={},M_Init._operateCondition.keyword&&$('input[name="k"]').val(M_Init._operateCondition.keyword);for(var i=!1,s=[],n=0;n<a.groupTitle.length;n++)if(a.groupTitle[n]){M_Init._dataCache.tags[a.groupTitle[n]]=[],M_Init._dataCache.tagsList[a.groupTitle[n]]=[],e+='<div class="wrap" id="bs_condition_'+n+'">',e+='<div class="side-tab-change"><span>'+a.groupTitle[n]+'<b class="bs_condition_sh" data-i="'+n+'">更多<i class="right-triangle"></i></b></span></div>',e+='<ul class="select-factor">';for(var l=0;l<a.group[a.groupTitle[n]].length;l++){e+='<li class="select-list">';var o=a.group[a.groupTitle[n]][l];i||(s=o.search_type.split(":"),"enum"==s[0]&&(i=!0)),e+=M_Operate._htmlMeta(a.groupTitle[n],o.search_type,o.column_name,o.column_desc,o.max_value,o.min_value),e+="</li>"}e+="</ul>",e+="</div>"}e+='<div class="wrap btn-union">                    <div class="side-tab-change"></div>                    <ul class="select-factor">                        <li><a class="tg-main-btn" id="bs_search_condition_confirm">确认</a></li>                        <li><a class="tg-assist-btn" onclick="M_Operate._resetMeta();">重置</a></li>                    </ul>                </div>',$(".auto-search-pop").html(e),i&&(M_Inside._dropShow(),M_Inside._dropSelected(),M_Inside._dropLeave()),$("#bs_search_condition_confirm").click(function(){M_Operate._btnSearch(t)}),$(".bs_condition_sh").each(function(){$(this).click(function(){var a=$(this).attr("data-i");$(this).find("i").hasClass("right-triangle")?($(this).find("i").removeClass("right-triangle"),$(this).find("i").addClass("bottom-triangle"),$("#bs_condition_"+a).css("height","auto")):($(this).find("i").removeClass("bottom-triangle"),$(this).find("i").addClass("right-triangle"),$("#bs_condition_"+a).css("height","100px"))})})},_htmlTag:function(a){var t="";t+="<b>玩家属性</b>";for(var e=0;e<a.length;e++)""!=a[e]&&(M_Init._dataCache.tabName||(M_Init._dataCache.tabName=a[e]),t+="<span",M_Init._dataCache.tabName==a[e]&&(t+=' class="selected"'),t+=">"+a[e]+"</span>");return t},_download:function(){$("#bs_btn_down").click(function(){var a=[];if(M_Init._dataCache.condition_type&&M_Init._dataCache.condition_style&&M_Init._dataCache.condition_reason)switch(M_Init._dataCache.condition_type){case"paid":a.push("s_pay_style="+B_Common._encodeUrl(M_Init._dataCache.condition_style)),a.push("s_pay_reason="+B_Common._encodeUrl(M_Init._dataCache.condition_reason));break;case"lost":a.push("s_lost_style="+B_Common._encodeUrl(M_Init._dataCache.condition_style)),a.push("s_lost_reason="+B_Common._encodeUrl(M_Init._dataCache.condition_reason))}M_Init._dataCache.userType&&a.push("user_type="+M_Init._dataCache.userType),M_Init._dataCache.columnType&&a.push("column_type="+M_Init._dataCache.columnType),a.push("service_id=3"),a.push("game_id="+M_Init._gameId),a.push("type="+B_Common._encodeUrl(M_Init._dataCache.tabName));var t="",e=M_Operate._getSearchTag();t=""!=e?a.join("&")+"&"+e:a.join("&"),B_Jump._go("openUrl",B_Port._init(M_Init._api.searchExcel)+"?"+t+"&excel_name="+B_Common._encodeUrl("玩家属性查询"))})},_getDetail:function(a,t){if(""==M_Init._dataCache.tabName)return B_Pop._init("msg",{content:"标签选择失败，请刷新页面重试！"}),!1;var e={};if(B_Page._size=10,M_Init._dataCache.condition_type&&M_Init._dataCache.condition_style&&M_Init._dataCache.condition_reason)switch(M_Init._dataCache.condition_type){case"paid":e.s_pay_style=M_Init._dataCache.condition_style,e.s_pay_reason=M_Init._dataCache.condition_reason;break;case"lost":e.s_lost_style=M_Init._dataCache.condition_style,e.s_lost_reason=M_Init._dataCache.condition_reason}e.type=M_Init._dataCache.tabName,e.service_id=3,e.game_id=M_Init._gameId,e.index=(a-1)*B_Page._size,M_Init._dataCache.userType&&(e.user_type=M_Init._dataCache.userType),M_Init._dataCache.columnType&&(e.column_type=M_Init._dataCache.columnType),e.limit=B_Page._size,e=B_Common._postData(e);var i="",s=M_Operate._getSearchTag();i=""!=s?e+"&"+s:e;var n=M_Init._dataCache.searchRank;n&&""!=n&&(i+="&"+n);var l=$("#bs_content_list .tg-table tbody"),o=$("#bs_content_list .tg-page-list");B_Port._ajax(M_Init._api.playerData,"get",!0,i,function(){l.html(B_Pre._loading()+'<tr class="empty"></tr>')},function(){l.html("")},function(t,e){t.list&&t.list.length>0?(l.html(M_Operate._htmlList(t.list)),$("#bs_number").html(t.total),o.html(B_Page._show({total:t.total,page:a},"number")),B_Page._click(a,function(a){M_Operate._getDetail(a)}),M_Dom._trSelected()):($("#bs_number").html("0"),l.html(B_Pre._empty("暂无数据")+'<tr class="empty"></tr>'),o.html(""))},function(a,t,e){switch(o.html(""),e+""){case"-1004":t="参数错误"}l.html(B_Pre._empty(t)+'<tr class="empty"></tr>')})},_getSearchDetail:function(a,t){var e="";"demo"==M_Init._controller&&(e="&d=1"),B_Pop._init("open",{type:2,scroll:!1,title:"用户详情",width:"1050px",height:"550px",shift:2,content:"insidesattribute_s.html?k="+a+"&g="+M_Init._gameId+e},"")},_htmlList:function(a){for(var t="",e=M_Init._dataCache.tagsList[M_Init._dataCache.tabName].length,i=0;i<a.length;i++){for(var s="<tr>",n="<tr>",l=0;l<e;l++){if(0==i&&""==$("#bs_content_list .tg-table thead").html()){var o=M_Init._dataCache.tagsList[M_Init._dataCache.tabName][l].column_desc;"span"==M_Init._dataCache.tagsList[M_Init._dataCache.tabName][l].search_type&&(o+='<i data-i="'+M_Init._dataCache.tagsList[M_Init._dataCache.tabName][l].column_name+'" class="tg-icon tg-sort-icon arrow-down"></i>'),s+="<th>"+o+"</th>"}n+="<td>"+a[i].source[M_Init._dataCache.tagsList[M_Init._dataCache.tabName][l].column_name]+"</td>"}n+='<td><button class="tg-main-btn" onclick="M_Operate._getSearchDetail(\''+a[i].id+"')\">查看详情</button></td>",n+="</tr>",t+=n,0==i&&""==$("#bs_content_list .tg-table thead").html()&&(s+="<th>操作</th></tr>",$("#bs_content_list .tg-table thead").html(s),$("#bs_content_list .tg-table thead i").each(function(a){$(this).click(function(){var a={};a.order_by_field=$(this).attr("data-i"),$(this).hasClass("arrow-down")?(a.order_type="asc",$(this).removeClass("arrow-down").addClass("arrow-up")):(a.order_type="desc",$(this).addClass("arrow-down").removeClass("arrow-up")),M_Init._dataCache.searchRank=B_Common._postData(a),M_Operate._getDetail(1)})}))}return t},_getSearchTag:function(a){var t={},e={},i=[],s={},n=$.trim($('input[name="k"]').val());return""!=n&&(t.keyword=n),e.keyword=n,M_Init._dataCache.tags&&$.each(M_Init._dataCache.tags,function(a,n){for(var l=0;l<n.length;l++)switch(n[l].type){case"span":var o=n[l].name+"_min",c=n[l].name+"_max",r=$.trim($("#"+o).val()),_=$.trim($("#"+c).val());e[o]=r,e[c]=_,""!=r&&(t[o]=r,i.push(n[l].name),s[n[l].name]={desc:n[l].desc,value:r+"-",type:n[l].type}),""!=_&&(t[c]=_,""!=r?s[n[l].name].value+=_:(i.push(n[l].name),s[n[l].name]={desc:n[l].desc,value:"-"+_,type:n[l].type}));break;case"query":var d=n[l].name,h=$.trim($("#"+d).val());e[d]=h,""!=h&&(t[d]=h,i.push(n[l].name),s[n[l].name]={desc:n[l].desc,value:h,type:n[l].type});break;case"enum":var d=n[l].name,h=$.trim($("#"+d).html());""!=h&&"全部"!=h?(t[d]=h,e[d]=h,i.push(n[l].name),s[n[l].name]={desc:n[l].desc,value:h,type:n[l].type}):e[d]=""}}),M_Init._operateCondition=e,a&&"character"==a&&(M_Init._dataCache.userTagShowMap=s,M_Operate._htmlConditionShow(i),i.length>0?$(".tg-header-slider").show():$(".tg-header-slider").hide()),t&&!B_Common._checkObjectIsEmpty(t)?B_Common._postData(t):""},_htmlConditionShow:function(a){if(M_Init._dataCache.userTagShowMap&&a){for(var t=M_Init._dataCache.userTagShowMap,e="",i=0;i<a.length;i++)t[a[i]]&&(e+='<li data-i="'+a[i]+'">'+t[a[i]].desc+"<b>"+t[a[i]].value+"</b><i>x</i></li>");$("#bs_scroll_content_1").html(e),""!=e&&M_Common._scroll();var s="";$("#bs_scroll_main i").each(function(){$(this).click(function(){$(this).parent("li").remove();var a="",t=$(this).parent("li").attr("data-i"),e=M_Init._dataCache.userTagShowMap;if(e&&e[t]){switch(e[t].type){case"span":a=t+"_min",$("#"+a).val(""),a=t+"_max",$("#"+a).val("");break;case"query":a=t,$("#"+a).val("");break;case"enum":a=t,$("#"+a).html("全部").attr("data-i","")}clearTimeout(s),s=setTimeout(function(){M_Operate._btnSearch("player")},800)}})})}else $("#bs_condition_list").html("")},_resetMeta:function(){M_Init._dataCache.tags&&$.each(M_Init._dataCache.tags,function(a,t){for(var e=0;e<t.length;e++)switch(t[e].type){case"span":var i=t[e].name+"_min",s=t[e].name+"_max";$("#"+i).val(""),$("#"+s).val("");break;case"query":var n=t[e].name;$("#"+n).val("");break;case"enum":var n=t[e].name;$("#"+n).html("全部").attr("data-i","")}})},_htmlMeta:function(a,t,e,i,s,n){var l=t.split(":"),o="",c="";switch(M_Init._dataCache.tagsList[a].push({key:e,name:i,type:l[0]}),l[0]){case"span":if(M_Init._dataCache.tags[a].push({type:l[0],name:e,desc:i}),l[1])switch(l[1]){case"date":o+="<div>",o+="<span>"+i+"</span>",o+="<input",c=e+"_min",M_Init._operateCondition[c]&&(o+=' value="'+M_Init._operateCondition[c]+'"'),o+=' readonly type="text" id="'+c+'" class="tg-input" onclick="laydate({istime: false, format: \'YYYY-MM-DD\'})" placeholder="'+n+'">',o+='<span class="zhi">至</span>',o+="<input",c=e+"_max",M_Init._operateCondition[c]&&(o+=' value="'+M_Init._operateCondition[c]+'"'),o+=' readonly type="text" id="'+c+'" class="tg-input" onclick="laydate({istime: false, format: \'YYYY-MM-DD\'})" placeholder="'+s+'">',o+="</div>";break;case"datetime":o+="<div>",o+="<span>"+i+"</span>",o+="<input",c=e+"_min",M_Init._operateCondition[c]&&(o+=' value="'+M_Init._operateCondition[c]+'"'),o+=' readonly type="text" id="'+c+'" class="tg-input"  onclick="laydate({istime: true, format: \'YYYY-MM-DD hh:mm:ss\'})" placeholder="'+n+'">',o+='<span class="zhi">至</span>',o+="<input",c=e+"_max",M_Init._operateCondition[c]&&(o+=' value="'+M_Init._operateCondition[c]+'"'),o+=' readonly type="text" id="'+c+'" class="tg-input"  onclick="laydate({istime: true, format: \'YYYY-MM-DD hh:mm:ss\'})" placeholder="'+s+'">',o+="</div>"}else o+="<div>",o+="<span>"+i+"</span>",o+="<input",c=e+"_min",M_Init._operateCondition[c]&&(o+=' value="'+M_Init._operateCondition[c]+'"'),o+=' type="text" id="'+c+'" class="tg-input" placeholder="'+n+'">',o+='<span class="zhi">至</span>',o+="<input",c=e+"_max",M_Init._operateCondition[c]&&(o+=' value="'+M_Init._operateCondition[c]+'"'),o+=' type="text" id="'+c+'" class="tg-input" placeholder="'+s+'">',o+="</div>";break;case"enum":var r=l[1]?l[1].split(","):[];if(r.length>0){M_Init._dataCache.tags[a].push({type:l[0],name:e,desc:i}),o+='<div class="tg-selected-drop"><span>'+i+"</span>",M_Init._operateCondition[e]&&(o+='<p class="tg-drop-text-part"><i class="tg-graph tg-triangle-gray-bottom"></i><span id="'+e+'" >全部</span></p><ul>',o+="<li><a>"+M_Init._operateCondition[e]+"</a></li>");for(var _=0;_<r.length;_++)0==_&&(M_Init._operateCondition[e]||(o+='<p class="tg-drop-text-part"><i class="tg-graph tg-triangle-gray-bottom"></i><span id="'+e+'" >全部</span></p><ul>'),o+="<li><a>全部</a></li>"),o+='<li><a data-i="'+r[_]+'">'+r[_]+"</a></li>";o+="</ul></div>"}break;case"query":M_Init._dataCache.tags[a].push({type:l[0],name:e}),o+="<div><span>"+i+"</span>",o+="<input",M_Init._operateCondition[e]&&(o+=' value="'+M_Init._operateCondition[e]+'"'),o+=' type="text"  id="'+e+'" class="tg-input"></div>'}return o}},M_Inside={_resetMeta:function(a){if(M_Init._dataCache.tags[M_Init._dataCache.tabName]&&M_Init._dataCache.tags[M_Init._dataCache.tabName].length>0)for(var t=0;t<M_Init._dataCache.tags[M_Init._dataCache.tabName].length;t++)switch(M_Init._dataCache.tags[M_Init._dataCache.tabName][t].type){case"span":var e=M_Init._dataCache.tags[M_Init._dataCache.tabName][t].name+"_min",i=M_Init._dataCache.tags[M_Init._dataCache.tabName][t].name+"_max";$("#lt_content_"+M_Init._dataCache.tabId+" #"+e).val(""),$("#lt_content_"+M_Init._dataCache.tabId+" #"+i).val("");break;case"query":var s=M_Init._dataCache.tags[M_Init._dataCache.tabName][t].name;$("#lt_content_"+M_Init._dataCache.tabId+" #"+s).val("");break;case"enum":var s=M_Init._dataCache.tags[M_Init._dataCache.tabName][t].name;$("#lt_content_"+M_Init._dataCache.tabId+" #"+s).html("全部").attr("data-i","")}switch(a){case"attribute":F_Attribute_Search._getDetail(1);break;case"log":F_Log_Search._getDetail(1)}},_tabChoose:function(a){$("#tab_list_li li").each(function(t){$(this).click(function(){$(this).addClass("tg-tab-active").siblings().removeClass("tg-tab-active");var t=$(this).attr("data-i");switch(M_Init._dataCache.tabId=t,M_Init._dataCache.tabName=$(this).attr("data-w"),$("#lt_content_"+t).show().siblings().hide(),a){case"attribute":""==$("#lt_content_"+t+" .tg-page-list").html()&&F_Attribute_Search._getDetail(1);break;case"log":""==$("#lt_content_"+t+" .tg-select-filter").html()&&F_Log_Search._getSearchMeta(),""==$("#lt_content_"+t+" .graph-show-part").html()&&F_Log_Chart._getChartInfo()}})})},_dropHtml:function(a,t,e,i,s){var n="";n+='<span class="fl hotword">'+t+"</span>",n+='<div class="tg-selected-drop fl" id="'+a+'">',n+='<p class="tg-drop-text-part">',n+='<i class="tg-graph tg-triangle-gray-bottom"></i><span data-i="'+e.id+'">'+e.name+"</span>",n+="</p>",n+='<ul style="display: none">';for(var l=0;l<i.length;l++)n+='<li><a data-i="'+i[l].id+'">'+i[l].name+"</a></li>";return n+="</ul></div>"},_dropShow:function(a){a=a||"tg-selected-drop",$("."+a+" p").unbind("click"),$("."+a+" p").click(function(){var t=$(this).parent("."+a).children("ul");"none"==t.css("display")?t.slideDown("fast"):t.slideUp("fast")})},_dropSelected:function(a,t){t=t||"tg-selected-drop",$("."+t+" ul li a").click(function(){var e=$(this).text(),i=$(this).attr("data-i"),s=$(this).parents("."+t).find("p span").attr("data-i"),n=$(this).parents("."+t).find("p span").attr("data-d");$(this).parents("."+t).find("p span").html(e).attr("data-i",i),$(this).parents("."+t).children("ul").hide(),s!=i&&a&&a(i,n)})},_dropLeave:function(a){a=a||"tg-selected-drop",$("."+a).mouseleave(function(a){$(this).children("ul").hide()})},_htmlMeta:function(a,t,e,i){var s=t.split(":"),n="";switch(M_Init._dataCache.tagsList[a].push({key:e,name:i,type:s[0]}),s[0]){case"span":if(M_Init._dataCache.tags[a].push({type:s[0],name:e}),s[1])switch(s[1]){case"date":n+="<div>",n+="<span>"+i+"</span>",n+='<input readonly type="text" id="'+e+'_min" class="tg-input" onclick="laydate({istime: false, format: \'YYYY-MM-DD\'})"><span class="zhi">至</span><input readonly type="text" id="'+e+'_max" class="tg-input" onclick="laydate({istime: false, format: \'YYYY-MM-DD\'})">',n+="</div>";break;case"datetime":n+="<div>",n+="<span>"+i+"</span>",n+='<input readonly type="text" id="'+e+'_min" class="tg-input"  onclick="laydate({istime: true, format: \'YYYY-MM-DD hh:mm:ss\'})"><span class="zhi">至</span><input readonly type="text" id="'+e+'_max" class="tg-input"  onclick="laydate({istime: true, format: \'YYYY-MM-DD hh:mm:ss\'})">',n+="</div>"}else n+="<div>",n+="<span>"+i+"</span>",n+='<input type="text" id="'+e+'_min" class="tg-input"><span class="zhi">至</span><input type="text" id="'+e+'_max" class="tg-input">',n+="</div>";break;case"enum":var l=s[1]?s[1].split(","):[];if(l.length>0){M_Init._dataCache.tags[a].push({type:s[0],name:e}),n+='<div class="tg-selected-drop"><span>'+i+"</span>";for(var o=0;o<l.length;o++)0==o&&(n+='<p class="tg-drop-text-part"><i class="tg-graph tg-triangle-gray-bottom"></i><span id="'+e+'" >全部</span></p><ul>',n+="<li><a>全部</a></li>"),n+='<li><a data-i="'+l[o]+'">'+l[o]+"</a></li>";n+="</ul></div>"}break;case"query":M_Init._dataCache.tags[a].push({type:s[0],name:e}),n+="<div><span>"+i+'</span><input type="text"  id="'+e+'" class="tg-input"></div>'}return n},_getSearchTag:function(){var a={};if(M_Init._dataCache.tags&&M_Init._dataCache.tags[M_Init._dataCache.tabName]&&M_Init._dataCache.tags[M_Init._dataCache.tabName].length>0)for(var t=0;t<M_Init._dataCache.tags[M_Init._dataCache.tabName].length;t++)switch(M_Init._dataCache.tags[M_Init._dataCache.tabName][t].type){case"span":var e=M_Init._dataCache.tags[M_Init._dataCache.tabName][t].name+"_min",i=M_Init._dataCache.tags[M_Init._dataCache.tabName][t].name+"_max",s=$.trim($("#lt_content_"+M_Init._dataCache.tabId+" #"+e).val()),n=$.trim($("#lt_content_"+M_Init._dataCache.tabId+" #"+i).val());""!=s&&(a[e]=s),""!=n&&(a[i]=n);break;case"query":var l=M_Init._dataCache.tags[M_Init._dataCache.tabName][t].name,o=$.trim($("#lt_content_"+M_Init._dataCache.tabId+" #"+l).val());""!=o&&(a[l]=o);break;case"enum":var l=M_Init._dataCache.tags[M_Init._dataCache.tabName][t].name,o=$.trim($("#lt_content_"+M_Init._dataCache.tabId+" #"+l).html());""!=o&&"全部"!=o&&(a[l]=o)}return a&&!B_Common._checkObjectIsEmpty(a)?B_Common._postData(a):""},_getSearchRank:function(){var a=[];return $("#lt_content_"+M_Init._dataCache.tabId+" .tg-table thead i").each(function(){$(this).hasClass("arrow-up")&&a.push($(this).attr("data-i"))}),a.length>0?"order_by_field="+a.join(","):""},_htmlHeadTab:function(a,t){for(var e='<div class="fl"><ul class="tg-tab-btn">',i=0;i<a.length;i++)e+='<li class="tg-tab-btn-normal',0==i&&(e+=" tg-tab-btn-selected"),e+='">'+a[i]+"</li>";e+="</ul></div>",$("#headerTop").prepend(e),$("#headerTop .fl ul li").each(function(a){$(this).click(function(){if(!$(this).hasClass("tg-tab-btn-selected"))switch($(this).addClass("tg-tab-btn-selected").siblings().removeClass("tg-tab-btn-selected"),t){case"lostanalysis":M_Init._dataCache.tabIndex=a,F_LostAnalysis_Info._formatInfo();break;case"habit":M_Init._dataCache.tabIndex=a,F_Habit_Info._formatInfo()}})})},_htmlChartTable:function(a,t){for(var e="",i=0;i<t.length;i++)e+=M_Inside._htmlChartTableFormat(i,t[i]);a.html(e)},_htmlChartTableFormat:function(a,t){var e="";switch(t.type){default:e+='<div class="tg-table-layout blockpart col-lg-12 col-md-12 col-sm-12 col-xs-12">';break;case"switch":case"region":case"switchTab":case"regionTab":e+='<div class="tg-table-layout tg-table-low-height blockpart col-lg-6 col-md-12 col-sm-12 col-xs-12">'}t.tips&&t.tips[0]&&"first"==t.tips[0].position?(e+='<h3 class="tip-hover">',e+='                <div class="tip-box-show">                    <i class="triangle-up"></i>                    <div class="tip-box-content">'+t.tips[0].content+"</div>                </div>"):e+="<h3>",M_Init._menuColumnAbnormal[t.name]&&(e+='<i class="alert-point"></i>'),e+=t.name+'</h3><div class="boxshadow tg-table-content">';var i="",s="",n="";if(t.tab&&t.tab.length>0){switch(s='<ul class="tg-tab-change-block',t.type){case"regionTab":case"switchTab":s+=" area-tab-change"}s+='" id="tab_list_li_'+a+'" data-i="'+a+'">';for(var l=0;l<t.tab.length;l++)s+='<li class="',0==l&&(s+="tg-tab-block-active"),t.tips[1]&&"second"==t.tips[1].position?(s+=' tip-hover">',s+='                        <div class="tip-box-show">                            <i class="triangle-up"></i>                            <div class="tip-box-content">'+t.tips[1].content[l]+"</div>                        </div>"):s+='">',M_Init._menuColumnAbnormal[t.name]&&M_Init._menuColumnAbnormal[t.name][t.tab[l]]&&(s+='<i class="alert-point"></i>'),s+=t.tab[l]+"</li>";i+=M_Inside._htmlChartTableDom(a+"_0",t.type),s+="</ul>"}else i+=M_Inside._htmlChartTableDom(a+"_0",t.type);switch(t.type){case"togetherTabAvg":n='<div class="avg-part" id="bs_avg_'+a+'_0"></div>'}return e+=s+n+i,e+="</div></div></div>"},_htmlChartTableDom:function(a,t,e){var i="",s="",n="";switch(t){case"togetherTabAvg":case"togetherTab":case"together":case"togetherTab20":case"together20":s="tg-table-selected";break;default:n="player-graph",i="b_none",s="tg-table"}var l="",o=a.split("_"),c=!1;switch(o.length>2?0==o[1]&&0==o[2]&&(c=!0):0==o[1]&&(c=!0),t){case"togetherTab20":case"together20":l+=c?'<div id="lt_main_area_'+a+'" class="cs_chart_table tg-only-chart">':'<div class="cs_chart_table tg-only-chart b_none" id="lt_main_area_'+a+'">';break;default:l+=c?'<div id="lt_main_area_'+a+'" class="cs_chart_table">':'<div class="cs_chart_table b_none" id="lt_main_area_'+a+'">'}switch(e&&(l+=e),t){case"table":case"tableColSpan":case"tableColSpan20":l+='<div id="bs_table_'+a+'" class="tg-table-wrap',l+="table"==t||"tableColSpan20"==t?" tg-table-no-padding":"",l+="tableColSpan20"==t?" tg-table-row-20":"",l+='">',l+='                            <div class="table-out-wrap no-margin-top" id="bs_table_list_'+a+'"></div>                            <ul class="tg-page-list" id="bs_page_'+a+'"></ul>                        </div>                        <div class="boxshadow tg-table-operation"  id="bs_icon_'+a+'">                            <ul class="fr">                            <li><b>下载数据</b><i class="tg-icon tg-download bs_icon_down" data-i="'+a+'"></i></li>                            </ul>                        </div>                   </div>';break;default:l+='<div class="insidelog-graph '+n+'" id="bs_chart_'+a+'" style="width:96%"></div>',l+='<div class="tg-table-wrap '+i,l+='" id="bs_table_'+a+'">',l+='                        <div class="table-out-wrap" id="bs_table_list_'+a+'"></div>                        <ul class="tg-page-list" id="bs_page_'+a+'"></ul>                    </div>                    <div class="boxshadow tg-table-operation"  id="bs_icon_'+a+'">                        <ul class="fl">                        <li><i class="tg-icon tg-pic-selected" id="bs_icon_chart_'+a+'"></i></li>                        <li><i class="tg-icon '+s+'" id="bs_icon_table_'+a+'"></i></li>                        </ul>                        <ul class="fr">                        <li><b>下载数据</b><i class="tg-icon tg-download bs_icon_down" data-i="'+a+'"></i></li>                        </ul>                    </div>',l+="</div>"}return l},_avgHtml:function(a,t){$("#bs_avg_"+a).html(t)},_tableName:function(a,t,e,i,s){var n="data";return a&&a[t]&&(n=a[t].name,a[t].tab&&a[t].tab.length>0&&a[t].tab[e]&&(n+="-"+a[t].tab[e]),i&&s?n+="（"+i+"至"+s+"）":i&&(n+="（"+i+"周前）")),n},_tableHtml:function(a,t,e){M_Init._dataCache["page_"+t]||(M_Init._dataCache["page_"+t]=e||10),B_Page._size=M_Init._dataCache["page_"+t];var i=M_Init._dataCache[t].body.length,s=(a-1)*B_Page._size,n=M_Init._dataCache[t].body.slice(s,s+B_Page._size),l='<table class="tg-table table table-bordered"><thead class="boxshadow">';if(M_Init._dataCache[t].formatHead)l+=M_Init._dataCache[t].formatHead;else{M_Init._dataCache[t].colspan&&(l+='<tr><th colspan="2"></th><th colspan="9">'+M_Init._dataCache[t].colspan+"</th></tr>"),l+="<tr>";for(var o=0;o<M_Init._dataCache[t].head.length;o++)l+="<th>"+M_Init._dataCache[t].head[o]+"</th>";l+="</tr>"}if(l+="</thead>",l+="<tbody>",M_Init._dataCache[t].colspan)for(var c=1,o=0;o<n.length;o++){l+="<tr>";for(var r=0;r<n[o].length;r++)r>1?(n[o][r].indexOf("%")>=0?(c=n[o][r].replace("%",""),c=parseFloat(c),c/=100):c=n[o][r]/n[o][1],c=c.toFixed(2),l+='<td class="td-blue" style="background: rgba(51, 152, 220,'+c+')">'):l+="<td>",l+=n[o][r]+"</td>";l+="</tr>"}else for(var o=0;o<n.length;o++){l+="<tr>";for(var r=0;r<n[o].length;r++)l+="<td>"+n[o][r]+"</td>";l+="</tr>"}l+="</tbody>",l+="</table></div>",$("#bs_table_list_"+t).html(l),$("#bs_page_"+t).html(B_Page._show({total:i,page:a,dom:t},"number")),B_Page._click(a,function(a,t){M_Inside._tableHtml(a,t)},t)},_downloadCsv:function(){$(".bs_icon_down").each(function(){$(this).click(function(){var a=$(this).attr("data-i");M_Common._downCsv(M_Init._dataCache[a])})})},_tabChangePerChart:function(a,t,e){switch(t){case"togetherTabAvg":case"togetherTab":case"togetherTab20":case"regionTab":case"switchTab":$("#tab_list_li_"+a+" li").each(function(a){$(this).click(function(){if(!$(this).hasClass("tg-tab-block-active")){$(this).addClass("tg-tab-block-active").siblings().removeClass("tg-tab-block-active");var t=$(this).parent("ul").attr("data-i");M_Inside._tabChangePerChartReset(e,t,a)}})})}},_tabChangePerChartReset:function(a,t,e){switch(a){case"additional":F_Additional_Info._chartHtml(t,e);break;case"paydata":F_PayData_Info._chartHtml(t,e);break;case"keypoint":F_Keypoint_Info._chartHtml(t,e);break;case"activity":F_Activity_Info._chartHtml(t,e);break;case"save":F_Save_Info._chartHtml(t,e);break;case"pay":F_Pay_Info._chartHtml(t,e);break;case"payosmosis":
F_PayOsmosis_Info._chartHtml(t,e);break;case"payconversion":F_PayConversion_Info._chartHtml(t,e);break;case"payhabit":F_PayHabit_Info._chartHtml(t,e);break;case"channelearn":F_ChannelEarn_Info._chartHtml(t,e);break;case"channelquality":F_ChannelQuality_Info._chartHtml(t,e);break;case"lost":F_Lost_Info._chartHtml(t,e);break;case"lostAnalysis":F_LostAnalysis_Info._chartHtml(t,e);break;case"lostfunnel":F_LostFunnel_Info._chartHtml(t,e);break;case"habit":F_Habit_Info._chartHtml(t,e);break;case"personality":F_Personality_Info._chartHtml(t,e)}},_chartTableIcon:function(a,t,e){var i=t+"_"+e;switch(a){case"together":case"togetherTab":case"togetherTabAvg":case"togetherTab20":case"together20":$("#bs_icon_"+i+" .fl .tg-icon").each(function(a){$(this).unbind("click"),$(this).click(function(){switch(a+""){case"0":$(this).hasClass("tg-pic-selected")?$("#bs_icon_"+i+" .fl .tg-icon").eq(1).hasClass("tg-table-selected")&&($(this).removeClass("tg-pic-selected").addClass("tg-pic"),$("#bs_chart_"+i).hide()):($(this).addClass("tg-pic-selected").removeClass("tg-pic"),$("#bs_chart_"+i).show(),M_Inside._chartResize(t,e));break;case"1":$(this).hasClass("tg-table-selected")?$("#bs_icon_"+i+" .fl .tg-icon").eq(0).hasClass("tg-pic-selected")&&($(this).removeClass("tg-table-selected").addClass("tg-table"),$("#bs_table_"+i).hide()):($(this).addClass("tg-table-selected").removeClass("tg-table"),$("#bs_table_"+i).show())}})});break;case"switch":case"region":case"switchTab":case"regionTab":$("#bs_icon_"+i+" .fl .tg-icon").each(function(a){$(this).unbind("click"),$(this).click(function(){switch(a+""){case"0":$(this).hasClass("tg-pic-selected")||($("#bs_icon_table_"+i).removeClass("tg-table-selected").addClass("tg-table"),$(this).addClass("tg-pic-selected").removeClass("tg-pic"),$("#bs_chart_"+i).show(),$("#bs_table_"+i).hide(),M_Inside._chartResize(t,e));break;case"1":$(this).hasClass("tg-table-selected")||($("#bs_icon_chart_"+i).removeClass("tg-pic-selected").addClass("tg-pic"),$(this).addClass("tg-table-selected").removeClass("tg-table"),$("#bs_table_"+i).show(),$("#bs_chart_"+i).hide())}})})}},_chartResize:function(a,t){for(var e=0;e<B_Chart._chartBarn.length;e++)B_Chart._chartBarn[e][0]!="bs_chart_"+a+"_"+t&&B_Chart._chartBarn[e][0]!="bs_chart_bs_chart_"+a+"_"+t||B_Chart._chartBarn[e][1].resize()}};