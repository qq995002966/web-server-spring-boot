var F_GameForum_Entrance={_init:function(e){if(B_Login._checkUpdate(),M_HeadFoot._headShow(2),M_Dom._menuList("游戏详情","7-3"),B_User._isDemoUser())B_Login._openLogin("background");else{M_Init._clean();var a=B_Common._getUrl("query");a.g?(M_Init._gameDetailId=a.g,B_Game._setLast(M_Init._gameDetailId,"outsideGameDetail")):e?(M_Init._gameDetailId=e,B_Game._setLast(M_Init._gameDetailId,"outsideGameDetail")):M_Init._gameDetailId||(M_Init._gameDetailId=M_Init._getGameId("outsideGameDetail")),M_Game._checkGameVisitList("gameForum")}}},F_GameForum_Info={_chartClick:function(e,a){var t={};switch(t.gameId=M_Init._gameDetailId,e){case"gameForumTotal":if(t.dateBegin=a.date,t.dateEnd=a.date,M_Init._dataCache.gameForumTotalData)for(var _=M_Init._dataCache.gameForumTotalData,i=0;i<_.length;i++)if(_[i][a.type]){t.infoIdList=_[i][a.type];break}break;case"gameEmotionRank":switch(t.dateBegin=a.date,t.dateEnd=a.date,a.type){case"正面情感帖数量":t.sentimentScore="1,2";break;case"负面情感帖数量":t.sentimentScore="-1,-2"}}M_Outside._redirectForum(t)},_domInit:function(){var e="";e+=M_Outside._domCreate("chartTableDate",1,"0_0","论坛帖子总量"),e+=M_Outside._domCreate("chartTableDate",2,"1_0","情感帖走势"),e+=M_Outside._domCreate("tableDate",3,"2_0","论坛帖子质量分析"),$("#ct_main_area").html(e),M_Inside._downloadCsv(),B_Date._chooseSection({autoCommit:!0,todayValid:!1},1,M_Init._dateChoose.begin,M_Init._dateChoose.end,function(e,a){e==M_Init._dateCache.begin&&M_Init._dateCache.end==a||(M_Init._dateCache.begin=e,M_Init._dateCache.end=a,F_GameForum_Info._getTotal())}),B_Date._chooseSection({autoCommit:!0,todayValid:!1},2,M_Init._dateChoose.begin,M_Init._dateChoose.end,function(e,a){e==M_Init._dateCache.begin2&&M_Init._dateCache.end2==a||(M_Init._dateCache.begin2=e,M_Init._dateCache.end2=a,F_GameForum_Info._getTendency())}),B_Date._chooseSection({autoCommit:!0,todayValid:!1},3,M_Init._dateChoose.begin,M_Init._dateChoose.end,function(e,a){e==M_Init._dateCache.begin3&&M_Init._dateCache.end3==a||(M_Init._dateCache.begin3=e,M_Init._dateCache.end3=a,F_GameForum_Info._getQuality())})},_getTotal:function(){var e="0_0",a=$("#bs_chart_"+e),t=$("#bs_table_list_"+e),_={};_.start_date=M_Init._dateCache.begin,_.end_date=M_Init._dateCache.end,_.project_id=M_Init._gameDetailId,_=B_Common._postData(_),B_Port._ajax("forumAnalyse","get",!0,_,function(){a.html(B_Pre._loading()),t.html(B_Pre._loading()),$("#bs_page_"+e).html("")},function(){a.html(""),t.html("")},function(t,_){if(t&&t.y_axis){var i={head:["日期"],body:[]},n={x_axis:[],y_axis:[],xFormatDate:!0,legendSelectMode:!0,legendIsShow:!0};n.x_axis=t.x_axis,$.each(t.y_axis,function(e,a){i.head.push(e);for(var t=0;t<a.length;t++)i.body[t]||(i.body[t]=[n.x_axis[t]]),i.body[t].push(a[t]);n.y_axis.push({name:e,data:a})}),M_Outside_Chart._chartData("barSum","bs_chart_"+e,n,"gameForumTotal"),i.name="论坛帖子总量("+M_Init._dateCache.begin+"至"+M_Init._dateCache.end+")",M_Init._dataCache[e]=i,M_Init._dataCache.gameForumTotalData=t.y_axis_desc,M_Inside._tableHtml(1,e),M_Inside._chartTableIcon("together",0,"0")}else a.html(B_Pre._empty("暂无数据"))},function(e,t,_){a.html(B_Pre._empty(t))})},_getTendency:function(){var e="1_0",a=$("#bs_chart_"+e),t=$("#bs_table_list_"+e),_={};_.start_date=M_Init._dateCache.begin2,_.end_date=M_Init._dateCache.end2,_.project_id=M_Init._gameDetailId,_=B_Common._postData(_),B_Port._ajax("forumAnalyseRate","get",!0,_,function(){a.html(B_Pre._loading()),t.html(B_Pre._loading()),$("#bs_page_"+e).html("")},function(){a.html(""),t.html("")},function(t,_){if(t&&t.x_axis){var i={head:["日期"],body:[]},n={x_axis:[],y_axis:[],xFormatDate:!0,legendSelectMode:!0,color:["#91c356","#e6646d"]};n.x_axis=t.x_axis,i.head.push("正面情感帖数量");for(var d=0;d<t.y_axis_positive.length;d++)i.body[d]||(i.body[d]=[n.x_axis[d]]),i.body[d].push(t.y_axis_positive[d]);n.y_axis.push({name:"正面情感帖数量",data:t.y_axis_positive}),i.head.push("负面情感帖数量");for(var d=0;d<t.y_axis_negative.length;d++)i.body[d]||(i.body[d]=[n.x_axis[d]]),i.body[d].push(t.y_axis_negative[d]);n.y_axis.push({name:"负面情感帖数量",data:t.y_axis_negative}),M_Outside_Chart._chartData("lineOpacity","bs_chart_"+e,n,"gameEmotionRank"),i.name="情感帖走势("+M_Init._dateCache.begin2+"至"+M_Init._dateCache.end2+")",M_Init._dataCache[e]=i,M_Inside._tableHtml(1,e),M_Inside._chartTableIcon("together",1,"0")}else a.html(B_Pre._empty("暂无数据"))},function(e,t,_){a.html(B_Pre._empty(t))})},_getQuality:function(){var e="2_0",a=$("#bs_table_list_"+e),t={};t.start_date=M_Init._dateCache.begin3,t.end_date=M_Init._dateCache.end3,t.project_id=M_Init._gameDetailId,t=B_Common._postData(t),B_Port._ajax("forumQualityAnalyse","get",!0,t,function(){a.html(B_Pre._loading()),$("#bs_page_"+e).html("")},function(){a.html("")},function(t,_){if(t&&t.useless_distri&&t.useless_distri.length>0){for(var i=t.useless_distri,n={head:["论坛名称","论坛帖子总量","正面情感帖总量","负面情感帖总量","广告帖占比","灌水帖占比","色情帖占比","脏话帖占比","买卖帖占比","其他帖占比"],body:[]},d=0;d<i.length;d++)if(n.body[d]=[i[d].show_forum_name,i[d].forum_num.total,i[d].forum_num.positive,i[d].forum_num.negative,"-","-","-","-","-","-"],i[d].detail_classify_distri&&i[d].detail_classify_distri.length>0)for(var o="",s=0;s<i[d].detail_classify_distri.length;s++)switch(o=(100*i[d].detail_classify_distri[s].useless_rate).toFixed(2),i[d].detail_classify_distri[s].useless_classify){case"买卖":n.body[d][8]=o;break;case"灌水":n.body[d][5]=o;break;case"色情":n.body[d][6]=o;break;case"脏话":n.body[d][7]=o;break;case"广告":n.body[d][4]=o;break;case"其他":n.body[d][9]=o}n.name="论坛帖子质量分析("+M_Init._dateCache.begin3+"至"+M_Init._dateCache.end3+")",M_Init._dataCache[e]=n,M_Inside._tableHtml(1,e)}else a.html(B_Pre._empty("暂无数据"))},function(e,t,_){a.html(B_Pre._empty(t))})}};