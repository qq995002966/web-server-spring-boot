var F_Attribute_Entrance={_init:function(){if(B_Login._checkUpdate(),M_HeadFoot._headShow(1),"demo"!=M_Init._controller&&B_User._isDemoUser())B_Login._openLogin("background");else{switch(M_Init._clean(),M_Init._controller){case"demo":M_Init._api.innerSearchMeta="demoInnerSearchMeta",M_Init._api.innerSearch="demoInnerSearch";break;default:M_Init._api.innerSearchMeta="innerSearchMeta",M_Init._api.innerSearch="innerSearch"}M_Init._gameIdRight=3,$("#tab_list_li").html(""),$("#lt_main_area").html(""),M_Init._dataCache.tags={},M_Init._dataCache.tagsList={},M_Init._dataCache.searchRank="",M_Common._getOrderGame("attribute","","2-1")}}},F_Attribute_Search={_getSearchMeta:function(){$("#tab_list_li").html(""),$("#lt_main_area").html("");var t=$("#lt_main_area"),a={};a.service_id=M_Init._gameIdRight,a.game_id=M_Init._gameId,a=B_Common._postData(a),B_Port._ajax(M_Init._api.innerSearchMeta,"get",!0,a,function(){t.html(B_Pre._loading("b_padding30"))},function(){t.html("")},function(t,a){if(t&&t.length>0){t=t[0];for(var e="",_="",i=0;i<t.groupTitle.length;i++){0==i&&(M_Init._dataCache.tabId=0,M_Init._dataCache.tabName=t.groupTitle[i]),M_Init._dataCache.tags[t.groupTitle[i]]=[],M_Init._dataCache.tagsList[t.groupTitle[i]]=[],_+='<div class="tg-table-wrap',_+=0==i?"":" b_none",_+='" id="lt_content_'+i+'">',_+='<div class="tg-select-filter">';for(var n=0;n<t.primary.length;n++)_+=M_Inside._htmlMeta(t.groupTitle[i],t.primary[n].search_type,t.primary[n].column_name,t.primary[n].column_desc);for(var r=0;r<t.group[t.groupTitle[i]].length;r++){var c=t.group[t.groupTitle[i]][r];_+=M_Inside._htmlMeta(t.groupTitle[i],c.search_type,c.column_name,c.column_desc)}_+='<div><button class="tg-main-btn bs_btn_search">查找</button><button class="tg-assist-btn bs_btn_reset">重置</button></div>',_+="</div>",_+='<div class="table-out-wrap"><table class="tg-table table table-bordered"><thead class="boxshadow"></thead><tbody></tbody></table></div>',_+='<ul class="tg-page-list" id="bs_page_'+(i+1)+'"></ul>',_+="</div>",e+='<li data-w="'+t.groupTitle[i]+'" data-i="'+i+'" class="',e+=0==i?"tg-tab-active":"",e+='">'+t.groupTitle[i]+"</li>"}$("#tab_list_li").html(e),$("#lt_main_area").html(_),M_Inside._tabChoose("attribute"),M_Inside._dropShow(),M_Inside._dropSelected(),M_Inside._dropLeave(),$(".bs_btn_search").click(function(){F_Attribute_Search._getDetail(1)}),$(".bs_btn_reset").click(function(){M_Inside._resetMeta("attribute")}),$("#bs_btn_down").click(function(){var t=[];t.push("service_id="+M_Init._gameIdRight),t.push("game_id="+M_Init._gameId);var a="",e=M_Inside._getSearchTag();a=""!=e?t.join("&")+"&"+e:t.join("&"),B_Jump._go("openUrl",B_Port._init("innerSearchCsv")+"?"+a+"&excel_name="+B_Common._encodeUrl("玩家属性查询"))})}F_Attribute_Search._getDetail(1)},function(a,e,_){t.html(B_Pre._empty(e))})},_getDetail:function(t){if(""==M_Init._dataCache.tabName)return B_Pop._init("msg",{content:"标签选择失败，请刷新页面重试！"}),!1;B_Page._size=10;var a={};a.type=M_Init._dataCache.tabName,a.service_id=M_Init._gameIdRight,a.game_id=M_Init._gameId,a.index=(t-1)*B_Page._size,a.limit=B_Page._size,a=B_Common._postData(a);var e=M_Inside._getSearchTag();""!=e&&(a=a+"&"+e);var _=M_Init._dataCache.searchRank;""!=_&&(a+="&"+_);var i=$("#lt_content_"+M_Init._dataCache.tabId+" .tg-table tbody"),n=$("#lt_content_"+M_Init._dataCache.tabId+" .tg-page-list");B_Port._ajax(M_Init._api.innerSearch,"get",!0,a,function(){i.html(B_Pre._loading()+'<tr class="empty"></tr>')},function(){i.html("")},function(a,e){a.list&&a.list.length>0?(i.html(F_Attribute_Search._htmlList(a.list)),n.html(B_Page._show({total:a.total,page:t},"number")),B_Page._click(t,function(t){F_Attribute_Search._getDetail(t)},parseInt(M_Init._dataCache.tabId)+1),M_Dom._trSelected()):(i.html(B_Pre._empty("暂无数据")+'<tr class="empty"></tr>'),n.html(""))},function(t,a,e){switch(n.html(""),e+""){case"-1004":a="参数错误"}i.html(B_Pre._empty(a)+'<tr class="empty"></tr>')})},_htmlList:function(t){for(var a="",e=M_Init._dataCache.tagsList[M_Init._dataCache.tabName].length,_=0;_<t.length;_++){for(var i="<tr>",n="<tr>",r=0;r<e;r++){if(0==_&&""==$("#lt_content_"+M_Init._dataCache.tabId+" .tg-table thead").html()){var c=M_Init._dataCache.tagsList[M_Init._dataCache.tabName][r].name;"span"==M_Init._dataCache.tagsList[M_Init._dataCache.tabName][r].type&&(c+='<i data-i="'+M_Init._dataCache.tagsList[M_Init._dataCache.tabName][r].key+'" class="tg-icon tg-sort-icon arrow-down"></i>'),i+="<th>"+c+"</th>"}n+="<td>"+t[_].source[M_Init._dataCache.tagsList[M_Init._dataCache.tabName][r].key]+"</td>"}n+='<td><button class="tg-main-btn" onclick="F_Attribute_Search._getSearchDetail(\''+t[_].id+"')\">查看详情</button></td>",n+="</tr>",a+=n,0==_&&""==$("#lt_content_"+M_Init._dataCache.tabId+" .tg-table thead").html()&&(i+="<th>操作</th></tr>",$("#lt_content_"+M_Init._dataCache.tabId+" .tg-table thead").html(i),$("#lt_content_"+M_Init._dataCache.tabId+" .tg-table thead i").each(function(t){$(this).click(function(){var t="order_by_field="+B_Common._encodeUrl($(this).attr("data-i"));$(this).hasClass("arrow-down")?(t+="&order_type="+B_Common._encodeUrl("asc"),$(".listContent"+M_Init._dataCache.tabId+" .table-part thead i").each(function(){$(this).addClass("arrow-down").removeClass("arrow-up")}),$(this).removeClass("arrow-down").addClass("arrow-up")):(t+="&order_type=desc",$(this).addClass("arrow-down").removeClass("arrow-up")),M_Init._dataCache.searchRank=t,F_Attribute_Search._getDetail(1)})}))}return a},_getSearchDetail:function(t){B_Pop._init("open",{type:2,scroll:!1,title:"用户详情",width:"1050px",height:"550px",shift:2,content:"insidesattribute_s.html?k="+t+"&g="+M_Init._gameId},"")}};