var F_Log_Entrance={_init:function(){if(B_Login._checkUpdate(),M_HeadFoot._headShow(4),"demo"!=M_Init._controller&&B_User._isDemoUser())B_Login._openLogin("background");else{switch(M_Init._clean(),M_Init._controller){case"demo":M_Init._api.innerLogChart="demoInnerLogChart",M_Init._api.innerLogType="demoInnerLogType",M_Init._api.innerLogMeta="demoInnerLogMeta",M_Init._api.innerLogSearch="demoInnerLogSearch",M_Init._api.innerSearchCsv="demoInnerSearchCsv";break;default:M_Init._api.innerLogChart="innerLogChart",M_Init._api.innerLogType="innerLogType",M_Init._api.innerLogMeta="innerLogMeta",M_Init._api.innerLogSearch="innerLogSearch",M_Init._api.innerSearchCsv="innerSearchCsv"}M_Init._gameIdRight=4,M_Init._dateCache.begin=M_Init._dateChoose.begin,M_Init._dateCache.end=M_Init._dateChoose.end,B_Date._chooseSection({autoCommit:!1,todayValid:!1},1,M_Init._dateChoose.begin,M_Init._dateChoose.end,function(t,a){if(t!=M_Init._dateCache.begin||M_Init._dateCache.end!=a){M_Init._dateCache.begin=t,M_Init._dateCache.end=a;for(var e=0;e<M_Init._dataCache.tabCount;e++)$("#bs_chart_"+e).html(""),F_Log_Chart._getChartInfo()}}),M_Init._dataCache.tabCount=0,M_Init._dataCache.tags={},M_Init._dataCache.tagsList={},M_Init._dataCache.searchRank="",M_Common._getOrderGame("log","","8-4")}}},F_Log_Chart={_getChartInfo:function(){var t=M_Init._dateCache.begin,a=M_Init._dateCache.end,e="bs_chart_"+M_Init._dataCache.tabId,_=$("#"+e),n={};n.type=M_Init._dataCache.tabName,n.start_date=t,n.end_date=a,n.game_id=M_Init._gameId,n=B_Common._postData(n),B_Port._ajax(M_Init._api.innerLogChart,"get",!0,n,function(){_.html(B_Pre._loading())},function(){_.html("")},function(_,n){if(_){var i=B_Date._dateArray(t,a),o=[],r={x_axis:[],y_axis:[{name:"数量",data:[]}]};$.each(i,function(t,a){r.x_axis.push(a.small),r.y_axis[0].data.push(0),o.push(a.big)});for(var c=0;c<_.length;c++){var d=$.inArray(_[c].data_date,o);d>-1&&(r.y_axis[0].data[d]=_[c].log_num)}M_Inside_Chart._chartData(40,e,r)}},function(t,a,e){_.html(B_Pre._empty(a))})}},F_Log_Tab={_getTab:function(){$("#tab_list_li").html(""),$("#lt_main_area").html("");var t={};t.game_id=M_Init._gameId,t=B_Common._postData(t),B_Port._ajax(M_Init._api.innerLogType,"get",!0,t,function(){B_Pop._init("load",{type:1,time:60,shade:[.6,"#000000"]})},function(){B_Pop._init("close")},function(t,a){t&&t.length>0&&($("#tab_list_li").html(F_Log_Tab._htmlTab(t)),M_Inside._tabChoose("log"),F_Log_Search._getSearchMeta(),F_Log_Chart._getChartInfo())},function(t,a,e){B_Pop._init("msg",{content:a})})},_htmlTab:function(t){var a="",e="";M_Init._dataCache.tabCount=t.length;for(var _=0;_<t.length;_++)M_Init._dataCache.tags[t[_].table_name]=[],M_Init._dataCache.tagsList[t[_].table_name]=[],e+=F_Log_Tab._htmlArea(_,t[_].table_desc),a+='<li data-i="'+_+'" data-w="'+t[_].table_name+'"',0==_&&(a+=' class="tg-tab-active"',M_Init._dataCache.tabId=0,M_Init._dataCache.tabName=t[_].table_name),a+=">"+t[_].table_desc+"</li>";return $("#lt_main_area").html(e),a},_htmlArea:function(t,a){var e='<div id="lt_content_'+t+'" class="';return e+=0==t?"":" b_none",e+='">',e+='<div class="graph-show-part cs_chart_log" id="bs_chart_'+t+'"></div>',e+='<div class="tg-table-wrap"><div class="tg-select-filter"></div>',e+='<div class="table-out-wrap"><table class="tg-table table table-bordered"><thead class="boxshadow"></thead><tbody></tbody></table></div>',e+='<ul class="tg-page-list" id="bs_page_'+(t+1)+'"></ul>',e+="</div></div>"}},F_Log_Search={_getSearchMeta:function(){var t=$("#lt_content_"+M_Init._dataCache.tabId+" .tg-select-filter"),a={};a.type=M_Init._dataCache.tabName,a.game_id=M_Init._gameId,a=B_Common._postData(a),B_Port._ajax(M_Init._api.innerLogMeta,"get",!0,a,function(){t.html(B_Pre._loading())},function(){t.html("")},function(a,e){if(a&&a.length>0){for(var _="",n=0;n<a.length;n++)_+=M_Inside._htmlMeta(M_Init._dataCache.tabName,a[n].search_type,a[n].column_name,a[n].column_desc);_+='<div><button class="tg-main-btn bs_btn_search">查找</button><button class="tg-assist-btn bs_btn_reset">重置</button></div>',t.html(_),M_Inside._dropShow(),M_Inside._dropSelected(),M_Inside._dropLeave(),$(".bs_btn_search").click(function(){F_Log_Search._getDetail(1)}),$(".bs_btn_reset").click(function(){M_Inside._resetMeta("log")}),$("#bs_btn_down").click(function(){var t=[];t.push("type="+M_Init._dataCache.tabName),t.push("service_id="+M_Init._gameIdRight),t.push("game_id="+M_Init._gameId);var a="",e=M_Inside._getSearchTag();a=""!=e?t.join("&")+"&"+e:t.join("&"),B_Jump._go("openUrl",B_Port._init(M_Init._api.innerSearchCsv)+"?"+a+"&excel_name="+B_Common._encodeUrl("海量日志搜索"))})}F_Log_Search._getDetail(1)},function(a,e,_){t.html(B_Pre._empty(e))})},_getDetail:function(t){B_Page._size=10;var a={};a.type=M_Init._dataCache.tabName,a.game_id=M_Init._gameId,a.index=(t-1)*B_Page._size,a.limit=B_Page._size,a=B_Common._postData(a);var e="",_=M_Inside._getSearchTag();e=""!=_?a+"&"+_:a;var n=M_Init._dataCache.searchRank;""!=n&&(e+="&"+n);var i=$("#lt_content_"+M_Init._dataCache.tabId+" .tg-table tbody"),o=$("#lt_content_"+M_Init._dataCache.tabId+" .tg-page-list");B_Port._ajax(M_Init._api.innerLogSearch,"get",!0,e,function(){i.html(B_Pre._loading()+'<tr class="empty"></tr>')},function(){i.html("")},function(a,e){a.list&&a.list.length>0?(i.html(F_Log_Search._htmlList(a.list)),o.html(B_Page._show({total:a.total,page:t},"number")),B_Page._click(t,function(t){F_Log_Search._getDetail(t)},parseInt(M_Init._dataCache.tabId)+1),M_Dom._trSelected()):(i.html(B_Pre._empty("暂无数据")+'<tr class="empty"></tr>'),o.html(""))},function(t,a,e){switch(o.html(""),e+""){case"-1004":a="参数错误"}i.html(B_Pre._empty(a)+'<tr class="empty"></tr>')})},_htmlList:function(t){for(var a="",e=M_Init._dataCache.tagsList[M_Init._dataCache.tabName].length,_=0;_<t.length;_++){for(var n="<tr>",i="<tr>",o=0;o<e;o++){if(0==_&&""==$("#lt_content_"+M_Init._dataCache.tabId+" .tg-table thead").html()){var r=M_Init._dataCache.tagsList[M_Init._dataCache.tabName][o].name;"span"==M_Init._dataCache.tagsList[M_Init._dataCache.tabName][o].type&&(r+='<i data-i="'+M_Init._dataCache.tagsList[M_Init._dataCache.tabName][o].key+'" class="tg-icon tg-sort-icon arrow-down"></i>'),n+="<th>"+r+"</th>"}i+="<td>"+t[_].source[M_Init._dataCache.tagsList[M_Init._dataCache.tabName][o].key]+"</td>"}i+="</tr>",a+=i,0==_&&""==$("#lt_content_"+M_Init._dataCache.tabId+" .tg-table thead").html()&&(n+="</tr>",$("#lt_content_"+M_Init._dataCache.tabId+" .tg-table thead").html(n),$("#lt_content_"+M_Init._dataCache.tabId+" .tg-table thead i").each(function(t){$(this).click(function(){var t={};t.order_by_field=$(this).attr("data-i"),$(this).hasClass("arrow-down")?(t.order_type="asc",$(".listContent"+M_Init._dataCache.tabId+" .table-part thead i").each(function(){$(this).addClass("arrow-down").removeClass("arrow-up")}),$(this).removeClass("arrow-down").addClass("arrow-up")):(t.order_type="desc",$(this).addClass("arrow-down").removeClass("arrow-up")),M_Init._dataCache.searchRank=B_Common._postData(t),F_Log_Search._getDetail(1)})}))}return a}};