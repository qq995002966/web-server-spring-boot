require(["frontmain"],function(){require(["jquery","layer","base","front","store.min"],function(){store=require("store.min"),F_Reg_Entrance._init()})});var F_Reg_Entrance={_init:function(){B_Login._backUrl("reg"),B_Captcha._getCaptcha("div_gt_embed"),S_HeadFoot._getLoginHead("注册"),F_Reg._check(),F_Reg._sms(),$(".h-logo").click(function(){B_Jump._go("target","index")}),B_Common._submitBind($("#bs_reg_btn"),$('input[name="usercode"],input[name="username"],input[name="userpass"],input[name="passcheck"]')),$('input[name="username"]').blur(function(){var e=$.trim($(this).val());""!=e&&B_Common._isMobile(e)?F_Reg._checkMobile(e):$("#bs_sms_send").attr("data-c",0)})}},F_Reg={_checkMobile:function(e){F_Reg._notice(0,"");var n={};n.mobile=e,n=B_Common._postData(n),B_Port._ajax("checkMobile","get",!0,n,null,null,function(e,n){$("#bs_sms_send").attr("data-c",1)},function(e,n,t){return $("#bs_sms_send").attr("data-c",2),F_Reg._notice(0,"该手机号已被注册"),!1})},_check:function(){$("#bs_reg_btn").click(function(){if(F_Reg._checkForm()){var e=$.trim($('input[name="usercode"]').val());if(""==e)return F_Reg._notice(3,"请输入验证码"),!1;if(F_Reg._notice(3,""),e.length<4)return F_Reg._notice(3,"验证码错误，请确认"),!1;F_Reg._notice(3,""),F_Reg._register()}})},_register:function(){var e=$.trim($('input[name="username"]').val()),n=$.trim($('input[name="userpass"]').val()),t={mobile_or_email:e,password:n,verify_code:$.trim($('input[name="usercode"]').val())};t=B_Common._postData(t),B_Port._ajax("register","post",!0,t,function(){$("#bs_reg_btn").html("注册中,请稍等...").attr("disabled",!0)},function(){$("#bs_reg_btn").html("注册").attr("disabled",!1)},function(t,_){return B_Storage._set("login",e),F_Reg._login(e,n),!1},function(e,n,t){return B_Pop._init("msg",{content:n}),!1})},_login:function(e,n){var t={};t.login_name=e,t.password=n,t.maxInactiveInterval=0,B_Login._in(t,function(){$("#bs_reg_btn").html("登录中,请稍等...").attr("disabled",!0)},function(){$("#bs_reg_btn").html("注册").attr("disabled",!1)},B_Jump._getUrl("information"))},_sms:function(){$("#bs_sms_send").click(function(){if(F_Reg._checkForm()){var e=$(this).attr("data-c");switch(e+""){case"0":return F_Reg._notice(0,"手机号验证失败"),!1;case"2":return F_Reg._notice(0,"该手机号已被注册"),!1}if(!B_CaptchaObj||!B_CaptchaObj.getValidate())return F_Reg._notice(3,"请滑动验证"),!1;F_Reg._notice(3,""),B_Captcha._getVCode($.trim($('input[name="username"]').val()))}})},_checkForm:function(){var e=$.trim($('input[name="username"]').val()),n=$.trim($('input[name="userpass"]').val()),t=$.trim($('input[name="passcheck"]').val());return""==e?(F_Reg._notice(0,"手机号不能为空"),!1):(F_Reg._notice(0,""),B_Common._isMobile(e)?(F_Reg._notice(0,""),""==n?(F_Reg._notice(1,"密码不能为空"),!1):(F_Reg._notice(1,""),n.length<6?(F_Reg._notice(1,"密码不能少于6位字符"),!1):(F_Reg._notice(1,""),n!=t?(F_Reg._notice(2,"再次输入的密码不同"),!1):(F_Reg._notice(2,""),0!=$('input[name="useragree"]').prop("checked")||(B_Pop._init("msg",{content:"请勾选并同意《隐私策略及服务条款》"}),!1))))):(F_Reg._notice(0,"手机号格式错误"),!1))},_notice:function(e,n){n&&B_Pop._init("msg",{content:n})}};