require(["frontmain"],function(){require(["jquery","layer","base","front","store.min"],function(){store=require("store.min"),F_Find_Entrance._init()})});var F_Find_Entrance={_init:function(){B_Captcha._getCaptcha("div_gt_embed"),B_Common._submitBind($("#bs_next_btn"),$('input[name="username"]')),B_Common._submitBind($("#bs_find_btn"),$('input[name="usercode"],input[name="userpass"],input[name="passcheck"]')),F_Find._next(),F_Find._check(),F_Find._sms(),S_HeadFoot._getLoginHead("重置密码"),$(".h-logo").click(function(){B_Jump._go("target","index")})}},F_Find={_next:function(){$("#bs_next_btn").click(function(){F_Find._notice(0,"");var n=$.trim($('input[name="username"]').val());return""==n?(F_Find._notice(0,"手机号不能为空"),!1):B_Common._isMobile(n)?void F_Find._existsMobile(n):(F_Find._notice(0,"手机号格式错误"),!1)})},_sms:function(){$("#bs_sms_send").click(function(){var n=$.trim($('input[name="username"]').val());return B_CaptchaObj&&B_CaptchaObj.getValidate()?(F_Find._notice(1,""),void B_Captcha._getVCode(n)):(F_Find._notice(1,"请滑动验证"),!1)})},_check:function(){$("#bs_find_btn").click(function(){if(F_Find._checkForm()){var n={mobile:$.trim($('input[name="username"]').val()),password:$.trim($('input[name="userpass"]').val()),verify_code:$.trim($('input[name="usercode"]').val())};n=B_Common._postData(n),B_Port._ajax("resetPass","post",!0,n,function(){$("#bs_find_btn").html("重置中,请稍等...").attr("disabled",!0)},function(){$("#bs_find_btn").html("确认重置").attr("disabled",!1)},function(n,t){return B_Pop._init("alert",{content:"重置成功，即将跳转到登录页"}),setTimeout(function(){return B_Jump._go("target","login")},3e3),!1},function(n,t,i){return B_Pop._init("msg",{content:t}),!1})}})},_checkForm:function(){var n=$.trim($('input[name="usercode"]').val());if(""==n)return F_Find._notice(1,"请输入验证码"),!1;if(F_Find._notice(1,""),n.length<4)return F_Find._notice(1,"验证码错误，请确认"),!1;F_Find._notice(1,"");var t=$.trim($('input[name="username"]').val()),i=$.trim($('input[name="userpass"]').val()),e=$.trim($('input[name="passcheck"]').val());return""==t?(B_Pop._init("msg",{content:"获取用户信息失败，请刷新页面重试"}),!1):""==i?(F_Find._notice(2,"密码不能为空"),!1):(F_Find._notice(2,""),i.length<6?(F_Find._notice(2,"密码不能少于6位字符"),!1):(F_Find._notice(2,""),i!=e?(F_Find._notice(3,"再次输入的密码不同"),!1):(F_Find._notice(3,""),!0)))},_notice:function(n,t){t&&B_Pop._init("msg",{content:t})},_existsMobile:function(n){var t=($("#bs_sms_send"),{});t.mobile=n,t=B_Common._postData(t),B_Port._ajax("register","get",!0,t,function(){$("#bs_next_btn").html("验证中,请稍等...").attr("disabled",!0)},function(){$("#bs_next_btn").html("下一步").attr("disabled",!1)},function(t,i){return t.mobile_exist+""=="0"?(F_Find._notice(0,"当前手机号码未注册"),!1):($("#bs_mobile").html(n),$(".first-step").hide(),$(".second-step").show(),void 0)},function(n,t,i){return B_Port._init("msg",{content:t}),!1})}};