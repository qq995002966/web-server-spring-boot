require(["frontmain"],function(){require(["jquery","layer","echarts","base","front","app/inside","app/outside","store.min"],function(){store=require("store.min"),echarts=require("echarts"),B_Login._checkUpdate();var a=B_Common._getUrl("query"),t={_getData:function(a){var e=$("#bs_radar"),i=$("#bs_gauge"),n={};n.project_id=a,n=B_Common._postData(n),B_Port._ajax("reputationIntroduce","get",!0,n,function(){e.html(B_Pre._loading()),i.html(B_Pre._loading())},function(){e.html(""),i.html("")},function(a,e){a.game_info&&(t._chartGauge(a.game_info.opinion_score),a.radar_data&&t._chartRadar(a.radar_data))},function(a,t,n){e.html(B_Pre._empty(t)),i.html(B_Pre._empty(t))})},_chartGauge:function(a){var t={gridTop:"25%",radius:"75%",detail:{formatter:"{value}"},data:[{value:a}],startAngle:210,endAngle:-30,name:"口碑评级",color:[[.4,"#5c3a77"],[.6,"#f7586a"],[.8,"#f49551"],[.9,"#f6d75a"],[1,"#33d184"]],pointerColor:"#436cbb",tooltipFormat:{formatter:"{a} : {c}"}};M_Outside_Chart._chartData("gauge_pop","bs_gauge",t);var e="",i="";a=parseInt(a),a<40?(i="gray",e="待提高"):a>=40&&a<60?(i="blue",e="中等"):a>=60&&a<80?(i="yellow",e="良好"):a>=80&&a<90?(i="red",e="优秀"):a>=90&&(i="purple",e="卓越"),$("#bs_gauge_desc").addClass(i).html(e),$("#bs_gauge_info").html('该游戏当前的口碑评级为：<b class="'+i+'">'+e+"</b>")},_chartRadar:function(a){var t={"正向反馈占比":"negative_weight","讨论热度":"post_weight","舆情走势":"stable_weight","有效反馈占比":"useless_weight","活跃人数":"user_weight","畅销排名":"appstore_weight"},e={indicator:[],data:{"当前游戏":[]},legendSelectMode:!0,color:["#3daae3","#2ed383"]};$.each(t,function(t,i){"畅销排名"==t?a.avg[i]&&(e.indicator.push({text:t,max:100}),e.data["当前游戏"].push(a.real[i]?(100*a.real[i]).toFixed(0):0)):(e.indicator.push({text:t,max:100}),e.data["当前游戏"].push(a.real[i]?(100*a.real[i]).toFixed(0):0))}),e.indicator&&e.indicator.length>0&&$("#bs_radar").length>0&&M_Outside_Chart._chartData("radar_pop","bs_radar",e)},_htmlOk:function(){var a="";a+='<p class="title">申请成功</p><img src="elements2.0/img/probation_app.png">',a+="<p>感谢您申请试用ThinkingGame"+$(".left h3").attr("data-i")+"服务</p><p>我们将在<b>2个工作日</b>内与您取得进一步联系</p>",a+='<div class="btn-union"><button class="tg-main-btn">返回</button> <button class="tg-assist-btn">在线客服</button></div>',$(".right").html(a),$(".tg-main-btn").click(function(){parent.B_Pop._init("close")}),$(".tg-assist-btn").click(function(){B_Jump._go("openUrl",B_Common._qqUrl())})},_htmlInit:function(){var e="";switch(e+='<div class="page-pop" style="padding: 0"><span class="close-pop" style="font-size:28px; top: -15px;">×</span>',a.from){case"game":e+='<div class="left rate-left tg-user-limit-pop">';break;default:e+='<div class="left rate-left">'}switch(e+=t._htmlNotice()+"</div>",e+='<div class="right boxshadow">'+t._htmlInput()+"</div>",e+="</div>",$("#probation_s").html(e),$(".close-pop").click(function(){parent.B_Pop._init("close")}),$("#bs_qq").click(function(){B_Jump._go("openUrl",B_Common._qqUrl())}),M_Inside._dropShow(),M_Inside._dropLeave(),M_Inside._dropSelected(),a.from){case"game":t._getData(a.gameId),$("#bs_recommend li").each(function(){$(this).click(function(){var a=B_Jump._getUrl("gameLight",{gameId:$(this).attr("data-i")});B_Jump._go("base",a),parent.B_Pop._init("close")})})}$(".tg-main-btn").click(function(){t._doApp()}),$(".tg-assist-btn").click(function(){parent.B_Pop._init("close")})},_htmlNotice:function(){var t="",e="";switch(a.from?e=a.from:parent.$("#topNav .top-tab-change li").each(function(a){if($(this).hasClass("top-tab-selected"))switch(a+""){case"1":e="operate";break;case"2":e="inside"}}),e){case"game":a.gameId&&!isNaN(a.gameId)||(a.gameId=B_Game._getDemoProjectId());var i=B_Game._getGame([a.gameId],1);i&&!B_Common._checkObjectIsEmpty(i)?i=i[a.gameId]:(a.gameId=B_Game._getDemoProjectId(),i=B_Game._getGame([a.gameId],1),i=i[a.gameId]);var n=B_Game._getAuthRecommend(),s="";n&&$.each(n,function(a,t){s+='<li data-i="'+a+'"><img src="'+t[0]+'" alt="'+t[1]+'"><p>'+t[1]+"</p><span>"+t[2]+"</span></li>"}),t+='                        <h3 data-i="游戏舆情雷达"><span>'+i[1]+'</span> 当前口碑评级 <b id="bs_gauge_desc"></b></h3><h3>开通后了解该游戏全网用户反馈</h3>                        <div class="graph-wrap">                            <div class="graph-part"><div id="bs_gauge" style="width: 100%; height: 100%"></div><span id="bs_gauge_info"></span></div>                            <div class="graph-part"><div id="bs_radar" style="width: 100%; height: 100%"></div></div>                        </div>                        <span>自然语言处理技术为您智能解读海量用户反馈，查看demo游戏</span>                        <ul id="bs_recommend">'+s+"</ul>";break;case"inside":t+='                        <h3 data-i="运营指标">申请试用<b>运营指标服务</b></h3>                        <span>运营统计结果毫厘不差 支持定制化产品统计纬度</span>                        <ul>                            <li><img src="elements2.0/img/pagepop/1.png" alt="">                                <p>接入游戏日志</p>                                <div class="rate-wrap">                                    <div class="rate1"></div>                                </div>                            </li>                            <li><img src="elements2.0/img/pagepop/2.png" alt="">                                <p>定制分析纬度</p>                                <div class="rate-wrap">                                    <div class="rate2"></div>                                </div>                                </li>                            <li><img src="elements2.0/img/pagepop/3.png" alt="">                                <p>登录后台 查看结果</p>                                <div class="rate-wrap">                                    <div class="rate3"></div>                                </div>                            </li>                        </ul>                        <p>运营指标分析结果包含：</p>                        <span>*新增、活跃、留存、付费、流失玩家关键指标</span>                        <span>*留存、付费、流失、渠道关键运营指标</span>                        <span>*关卡驻留、成长进度、核心玩法、虚拟消费、英雄、社交定制化指标</span>';break;default:t+='                        <h3 data-i="智能分析">申请试用<b>智能分析服务</b></h3>                        <span>用智能分析结果支持运营决策 有效提升游戏竞争力</span>                        <ul>                            <li><img src="elements2.0/img/pagepop/1.png" alt="">                                <p>接入游戏日志</p>                                <div class="rate-wrap">                                    <div class="rate1"></div>                                </div>                            </li>                            <li><img src="elements2.0/img/pagepop/2.png" alt="">                                <p>算法模型选参调优</p>                                <div class="rate-wrap">                                    <div class="rate2"></div>                                </div>                                </li>                            <li><img src="elements2.0/img/pagepop/3.png" alt="">                                <p>登录后台 查看结果</p>                                <div class="rate-wrap">                                    <div class="rate3"></div>                                </div>                            </li>                        </ul>                        <p>智能分析结果包含：</p>                        <span>*为您揭晓不同玩家群的特征</span>                        <span>*智能分析影响玩家付费、流失的因素</span>                        <span>*自定义查询玩家群属性分布</span>                        <span>*支持海量玩家行为日志搜索</span>'}return t},_htmlInput:function(){var a={company_type:0,job_type:0,company_name:"",real_name:"",email:"",mobile:""};if(B_Login._user&&B_Login._user.user){var e=B_Login._user.user;"demo"!=e.nick_name&&(a.company_type=e.company_type,a.job_type=e.job_type,a.company_name=e.company_name,a.real_name=e.real_name,a.email=e.email,a.mobile=e.mobile)}var i='<p class="title">立即申请开通</p>';return i+="<ul>",i+='<li><p>公司名称：</p><input type="text" name="user_company" placeholder="您当前就职的公司" maxlength="32" value="'+a.company_name+'"></li>',i+='<li><p>联系人：</p><input type="text" name="user_name" placeholder="请输入您的真实姓名" maxlength="16" value="'+a.real_name+'"></li>',i+='<li><p>公司邮箱：</p><input type="text" name="user_email" placeholder="请填写您在公司使用的公司邮箱" maxlength="64" value="'+a.email+'"></li>',i+="</ul><ul>",i+="<li><p>公司类型：</p>",i+='<div id="selectWrap"><div id="bs_company_type" class="dropDown tg-selected-drop">',B_User._information.companyArr[a.company_type]?i+='<p><span data-i="'+a.company_type+'">'+B_User._information.companyArr[a.company_type]+'</span><i class="tg-triangle-gray-bottom"></i></p>':i+='<p><span data-i="">请选择公司类型</span><i class="drop-icon"></i></p>',i+='<ul class="b_none">'+t._htmlSelect(B_User._information.companyArr)+"</ul></div></div>",i+="</li>",i+='<li><p>手机号码：</p><input type="text" name="user_phone" placeholder="请填写能联系到您的手机号码" maxlength="11" value="'+a.mobile+'"></li>',i+="<li><p>公司职位：</p>",i+='<div id="selectWrap"><div id="bs_job_type" class="dropDown tg-selected-drop">',B_User._information.jobArr[a.job_type]?i+='<p><span data-i="'+a.job_type+'">'+B_User._information.jobArr[a.job_type]+'</span><i class="tg-triangle-gray-bottom"></i></p>':i+='<p><span data-i="">请选择公司职位</span><i class="drop-icon"></i></p>',i+='<ul class="b_none">'+t._htmlSelect(B_User._information.jobArr)+"</ul></div></div>",i+="</li>",i+="</ul>",i+='<div class="btn-union"><button class="tg-main-btn">申请开通</button> <button class="tg-assist-btn">继续浏览</button></div>',i+='<span>您也可以咨询<b id="bs_qq">在线客服</b>或者服务热线021-60492625，进一步了解申请开通的详细信息。</span>'},_doApp:function(){var a=$.trim($('input[name="user_name"]').val()),e=$.trim($('input[name="user_company"]').val()),i=$.trim($('input[name="user_email"]').val()),n=$.trim($('input[name="user_phone"]').val()),s=$("#bs_company_type p span").attr("data-i"),p=$("#bs_job_type p span").attr("data-i"),o=$(".left h3").attr("data-i");if(""==e)return B_Pop._init("msg",{content:"公司名称必须填写"}),!1;if(""==s)return B_Pop._init("msg",{content:"公司类型必须选择"}),!1;if(""==a)return B_Pop._init("msg",{content:"联系人必须填写"}),!1;if(""==n)return B_Pop._init("msg",{content:"手机号码必须填写"}),!1;if(!B_Common._isMobile(n))return B_Pop._init("msg",{content:"手机号格式错误"}),!1;if(""==i)return B_Pop._init("msg",{content:"公司邮箱必须填写"}),!1;if(!B_Common._isMail(i))return B_Pop._init("msg",{content:"公司邮箱式错误"}),!1;if(""==p)return B_Pop._init("msg",{content:"公司职位必须选择"}),!1;var r=$(".blue-button"),l={};l.user_company=e,l.company_type=s,l.user_name=a,l.user_phone=n,l.email=i,l.job_type=p,l.apply_product=o,l.project_names="",l=B_Common._postData(l),B_Port._ajax("operationApply","post",!0,l,function(){B_Common._btnTextStatus("disable",r,{disable:"提交中.."}),B_Common._btnTextStatus("disable",$(".tg-assist-btn"),{disable:"继续浏览"})},function(){B_Common._btnTextStatus("normal",r,{normal:"申请开通"}),B_Common._btnTextStatus("normal",$(".tg-assist-btn"),{normal:"继续浏览"})},function(a,e){t._htmlOk()},function(a,t,e){B_Pop._init("msg",{content:t})})},_htmlSelect:function(a){for(var t="",e=0;e<a.length;e++)t+='<li><a data-i="'+e+'">'+a[e]+"</a></li>";return t}};t._htmlInit()})});