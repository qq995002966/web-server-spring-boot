var F_LostFunnel_Entrance={_init:function(){if(B_Login._checkUpdate(),M_HeadFoot._headShow(1),"demo"!=M_Init._controller&&B_User._isDemoUser())B_Login._openLogin("background");else{switch(M_Init._clean(),M_Init._controller){case"demo":M_Init._api.innerLostFunnel="demoInnerLostFunnel";break;default:M_Init._api.innerLostFunnel="innerLostFunnel"}M_Init._dateCache.begin=M_Init._dateChoose.begin,M_Common._getOrderGame("lostfunnel","","1-5-2"),B_Date._chooseSingle({autoCommit:!1,todayValid:!1},1,M_Init._dateChoose.begin,M_Init._dateChoose.begin,function(n,e){n!=M_Init._dateCache.begin&&(M_Init._dateCache.begin=n,F_LostFunnel_Info._getInfo())})}}},F_LostFunnel_Info={_init:[{type:"togetherTab",name:"流失漏斗",tab:["新增玩家","活跃玩家","付费玩家"],tips:[{},{position:"second",content:["所选日期的新增用户，在之后时间区间内的流失分布情况","所选日期的活跃用户，在之后时间区间内的流失分布情况","所选日期的付费用户，在之后时间区间内的流失分布情况"]}]}],_port:[[[{name:"留存玩家数",key:"new|y_user_num"},{name:"玩家留存占比",key:"new|y_user_rate"}],[{name:"留存玩家数",key:"active|y_user_num"},{name:"玩家留存占比",key:"active|y_user_rate"}],[{name:"留存玩家数",key:"paid|y_user_num"},{name:"玩家留存占比",key:"paid|y_user_rate"}]]],_domInit:function(){M_Inside._htmlChartTable($("#ct_main_area"),F_LostFunnel_Info._init),M_Inside._downloadCsv(),F_LostFunnel_Info._getInfo()},_getInfo:function(){for(var n=M_Init._dateCache.begin,e=[],t=0;t<F_LostFunnel_Info._init.length;t++)e.push("bs_chart_"+t+"_0");var _={};_.data_date=n,_.game_id=M_Init._gameId,_=B_Common._postData(_),B_Port._ajax(M_Init._api.innerLostFunnel,"get",!0,_,function(){for(var n=0;n<e.length;n++)$("#"+e[n]).html(B_Pre._loading())},function(){for(var n=0;n<e.length;n++)$("#"+e[n]).html("")},function(n,e){if(n){M_Init._dataCache.data=n;for(var t=0;t<F_LostFunnel_Info._init.length;t++)if(F_LostFunnel_Info._init[t].tab.length>0){M_Init._dataCache["position_"+t]||(M_Init._dataCache["position_"+t]=0);for(var _=0;_<F_LostFunnel_Info._init[t].tab.length;_++)if(M_Init._dataCache["position_"+t]==_){F_LostFunnel_Info._chartHtml(t,_),M_Inside._chartTableIcon(F_LostFunnel_Info._init[t].type,t,_);break}M_Inside._tabChangePerChart(t,F_LostFunnel_Info._init[t].type,"lostfunnel")}}},function(n,t,_){for(var a=0;a<e.length;a++)$("#"+e[a]).html(B_Pre._empty(t))})},_chartHtml:function(n,e){M_Init._dataCache["position_"+n]=e;var t=M_Init._dataCache.data,_={x_axis:[],y_axis:[],yFormat:""},a={},i=50,o="%";switch(n+""){case"0":_.yDouble=!0,_.yDoubleLabel=["","%"],_.tooltip={type:"diff",num:2,unit:["人","%"]},a={head:["","玩家数量","玩家留存占比","相对留存率"],body:[]}}for(var s=F_LostFunnel_Info._port[n][e],r=0;r<s.length;r++){var l=s[r].key.split("|"),d=s[r].name;if(i=50,t[l[0]]&&t[l[0]][l[1]]){var h=t[l[0]][l[1]];_.x_axis=t[l[0]].x_axis;for(var u=0;u<h.length;u++)switch(a.body[u]||(a.body[u]=[_.x_axis[u]]),r+""){case"0":a.body[u].push(h[u]);break;case"1":a.body[u].push(h[u]+o),0==u?a.body[u].push("-"):a.body[u].push(t[l[0]].user_rate_span[u-1]+o)}0==r?_.y_axis.push({type:"bar",name:d,data:h}):_.y_axis.push({type:"line",name:d,data:h})}}a.name=M_Inside._tableName(F_LostFunnel_Info._init,n,e,M_Init._dateCache.begin,M_Init._dateCache.end),e=0,M_Init._dataCache[n+"_"+e]=a,M_Inside_Chart._chartData(i,"bs_chart_"+n+"_"+e,_),M_Inside._tableHtml(1,n+"_"+e)}};