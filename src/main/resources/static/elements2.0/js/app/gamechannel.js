var F_GameChannel_Entrance={_init:function(a){if(B_Login._checkUpdate(),M_HeadFoot._headShow(2),M_Dom._menuList("游戏详情","7-4"),B_User._isDemoUser())B_Login._openLogin("background");else{M_Init._clean();var e=B_Common._getUrl("query");e.g?(M_Init._gameDetailId=e.g,B_Game._setLast(M_Init._gameDetailId,"outsideGameDetail")):a?(M_Init._gameDetailId=a,B_Game._setLast(M_Init._gameDetailId,"outsideGameDetail")):M_Init._gameDetailId||(M_Init._gameDetailId=M_Init._getGameId("outsideGameDetail")),M_Game._checkGameVisitList("gameChannel")}}},F_GameChannel_Info={_chartClick:function(a,e){var t={};switch(t.gameId=M_Init._gameDetailId,a){case"gameChannelCount":if(t.dateBegin=M_Init._dateCache.begin,t.dateEnd=M_Init._dateCache.end,M_Init._dataCache.channelCount)for(var n=M_Init._dataCache.channelCount,i=0;i<n.length;i++)if(n[i].source_name==M_Init._dataCache.currentChannel&&n[i].rating_name==e.name){t.channelId=n[i].source_type,t.esFieldName=n[i].es_field_name,t.esFieldVal=n[i].es_field_val;break}}M_Outside._redirectComments(t)},_domInit:function(){var a="";a+=M_Outside._domCreate("chartTableDateTab",1,"0_0","渠道评分统计"),a+=F_GameChannel_Info._htmlAnalyse(),$("#ct_main_area").html(a),M_Inside._downloadCsv(),B_Date._chooseSection({autoCommit:!0,todayValid:!1},1,M_Init._dateChoose.begin,M_Init._dateChoose.end,function(a,e){a==M_Init._dateCache.begin&&M_Init._dateCache.end==e||(M_Init._dateCache.begin=a,M_Init._dateCache.end=e,F_GameChannel_Info._getCount())}),B_Date._chooseSection({autoCommit:!0,todayValid:!1},2,M_Init._dateChoose.begin,M_Init._dateChoose.end,function(a,e){a==M_Init._dateCache.begin2&&M_Init._dateCache.end2==e||(M_Init._dateCache.begin2=a,M_Init._dateCache.end2=e,F_GameChannel_Info._getEmotion())})},_htmlAnalyse:function(){var a='<div class="blockpart tg-table-layout  col-lg-12 col-md-12 col-sm-12 col-xs-12">';return a+="<h3>渠道评论情感分析</h3>",a+='<div class="boxshadow tg-table-content channel-emotion-analysis">',a+='        <div id="bs_rank_select">            <div class="tg-selected-drop tg-date-fl">                <span>日期</span>                <p class="tg-drop-text-part">                <i class="tg-graph tg-triangle-gray-bottom"></i>                <span class="hot-area" id="dc2"></span>                <input id="db2" type="hidden" value="">                <input id="de2" type="hidden" value="">                </p>            </div>        </div>',a+='<div class="wrap" id="bs_analyse_show"></div>',a+="</div>",a+="</div>"},_searchWord:function(a,e){M_Outside._redirectComments({gameId:M_Init._gameDetailId,dateBegin:M_Init._dateCache.begin2,dateEnd:M_Init._dateCache.end2,sentimentKeywords:a,sentimentKeywordsType:e,ratingStageList:e})},_htmlAnalyseShow:function(a){var e="";if(e+='<div class="fl"><div class="graph-part"><div id="bs_analyse_chart" style="width: 100%; height: 100%"></div></div></div>',e+='<div class="fr">',e+='<ul class="positive-comment">',e+="<li><b></b><span>正面评论</span></li>",e+='<i class="tg-icon triangle-shadow"></i>',e+="<ul>",a.pos&&a.pos.length>0)for(var t=0;t<a.pos.length;t++)e+="<li onclick=\"F_GameChannel_Info._searchWord('"+a.pos[t]+"',1);\">"+a.pos[t]+"</li>";if(e+="</ul>",e+="</ul>",e+='<ul class="negative-comment">',e+="<li><b></b><span>负面评论</span></li>",e+='<i class="tg-icon triangle-shadow"></i>',e+="<ul>",a.neg&&a.neg.length>0)for(var t=0;t<a.neg.length;t++)e+="<li onclick=\"F_GameChannel_Info._searchWord('"+a.neg[t]+"',-1);\">"+a.neg[t]+"</li>";return e+="</ul>",e+="</ul>",e+="</div>"},_chartCount:function(a){var e={head:["评级","数量"],body:[]},t={x_axis:[],y_axis:[]};if(M_Init._dataCache.countData&&M_Init._dataCache.countData[M_Init._dataCache.currentChannel]){var n=M_Init._dataCache.countData[M_Init._dataCache.currentChannel];t.x_axis=n.x,t.y_axis.push({name:M_Init._dataCache.currentChannel,data:n.y});for(var i=0;i<n.y.length;i++)e.body[i]||(e.body[i]=[t.x_axis[i]]),e.body[i].push(n.y[i]);M_Outside_Chart._chartData("bar","bs_chart_"+a,t,"gameChannelCount"),M_Init._dataCache[a]=e,M_Inside._tableHtml(1,a),M_Inside._chartTableIcon("together",0,"0")}},_getCount:function(){var a="0_0",e=$("#bs_chart_"+a),t=$("#bs_table_list_"+a),n={};n.start_date=M_Init._dateCache.begin,n.end_date=M_Init._dateCache.end,n.project_id=M_Init._gameDetailId,n=B_Common._postData(n),B_Port._ajax("channelCount","get",!0,n,function(){e.html(B_Pre._loading()),t.html(B_Pre._loading()),$("#bs_page_"+a).html("")},function(){e.html(""),t.html("")},function(t,n){if(t&&t.channel_rating_distri&&t.channel_rating_distri.length>0){M_Init._dataCache.channelCount=t.channel_rating_distri;for(var i=[],_={},s="",d=[],l=0,o=0;o<t.channel_rating_distri.length;o++){if(s=t.channel_rating_distri[o],$.inArray(s.source_name,i)>-1||i.push(s.source_name),!_[s.source_name]){d=s.rating_names.split(","),_[s.source_name]={x:d,y:[]};for(var c=0;c<d.length;c++)_[s.source_name].y.push(0)}l=$.inArray(s.rating_name,_[s.source_name].x),l>-1&&(_[s.source_name].y[l]=s.num)}if(M_Init._dataCache.countData=_,!M_Init._dataCache.currentChannel){for(var r="",o=0;o<i.length;o++)0==o?(M_Init._dataCache.currentChannel=i[o],r+='<li class="tg-tab-block-active">'):r+="<li>",r+=i[o]+"</li>";$("#bs_tab_"+a).html(r),$("#bs_tab_"+a+" li").each(function(){$(this).click(function(){$(this).hasClass("tg-tab-block-active")||($(this).addClass("tg-tab-block-active").siblings("li").removeClass("tg-tab-block-active"),M_Init._dataCache.currentChannel=$(this).html(),F_GameChannel_Info._chartCount(a))})})}F_GameChannel_Info._chartCount(a)}else e.html(B_Pre._empty("暂无数据"))},function(a,t,n){e.html(B_Pre._empty(t))})},_getEmotion:function(){var a=$("#bs_analyse_show"),e={};e.start_date=M_Init._dateCache.begin2,e.end_date=M_Init._dateCache.end2,e.project_id=M_Init._gameDetailId,e=B_Common._postData(e),B_Port._ajax("channelAnalyse","get",!0,e,function(){a.html(B_Pre._loading())},function(){a.html("")},function(e,t){if(e){var n={neg:[],pos:[]};if(e.senti_word_distri&&e.senti_word_distri.length>0)for(var i=0;i<e.senti_word_distri.length;i++)n[e.senti_word_distri[i].senti_type]&&n[e.senti_word_distri[i].senti_type].push(e.senti_word_distri[i].keyword);if(a.html(F_GameChannel_Info._htmlAnalyseShow(n)),e.senti_date_distri&&e.senti_date_distri.length>0){for(var _={color:["#71bc33","#f33f57"],x_axis:[],y_axis:[{name:"正面评论",data:[]},{name:"负面评论",data:[]}],xFormatDate:!0,legendSelectMode:!0},i=0;i<e.senti_date_distri.length;i++)_.x_axis.push(e.senti_date_distri[i].data_date),_.y_axis[0].data.push(e.senti_date_distri[i].pos_num),_.y_axis[1].data.push(-e.senti_date_distri[i].neg_num);M_Outside_Chart._chartData("barSum","bs_analyse_chart",_)}else $("#bs_analyse_chart").html(B_Pre._empty("暂无数据"))}else a.html(B_Pre._empty("暂无数据"))},function(e,t,n){a.html(B_Pre._empty(t))})}};