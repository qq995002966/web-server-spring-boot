var F_GameLight_Entrance={_init:function(e){if(B_Login._checkUpdate(),M_HeadFoot._headShow(2),M_Dom._menuList("游戏详情","7-7"),B_User._isDemoUser())B_Login._openLogin("background");else{M_Init._clean();var t=B_Common._getUrl("query");t.g?(M_Init._gameDetailId=t.g,B_Game._setLast(M_Init._gameDetailId,"outsideGameDetail")):e?(M_Init._gameDetailId=e,B_Game._setLast(M_Init._gameDetailId,"outsideGameDetail")):M_Init._gameDetailId||(M_Init._gameDetailId=M_Init._getGameId("outsideGameDetail")),M_Game._checkGameVisitList("gameLight")}}},F_GameLight_Info={_domInit:function(){var e="";e+='            <div class="blockpart col-lg-6 col-md-12 col-sm-12 col-xs-12 widthLarge">                <h3>游戏简介</h3>                <div class="boxshadow game-summary-2"></div>            </div>            <div class="blockpart col-lg-3 col-md-12 col-sm-12 col-xs-12 widthMid">                <h3>游戏口碑评级</h3>                <div class="boxshadow game-level-2"><div class="graph-part cursor-default" id="bs_gauge" style="width: 100%; height: 100%"></div><div id="bs_gauge_desc" class="des"></div></div>            </div>            <div class="blockpart col-lg-3 col-md-12 col-sm-12 col-xs-12 widthMid">                <h3>游戏舆情状态</h3>                <div class="boxshadow  game-yuqing-graph-2"><div class="graph-part" id="bs_radar" style="width: 100%; height: 100%"></div></div>            </div>',e+=M_Outside._domCreate("analysisChartTableDate",5,"0_0","论坛帖子总量"),e+='            <div class="blockpart col-lg-12 col-md-12 col-sm-12 col-xs-12 ">                <h3>论坛反馈分析</h3>                <div class="tg-selected-drop tg-date-fl">                    <span>日期</span>                    <p class="tg-drop-text-part"><i class="tg-graph tg-triangle-gray-bottom"></i><span class="hot-area" id="dc1"></span><input id="db1" type="hidden" value=""><input id="de1" type="hidden" value=""></p>                </div>                <div class="boxshadow luntan-back-2"></div>            </div>            <div class="blockpart  col-lg-12 col-md-12 col-sm-12 col-xs-12">                <h3>论坛热词解读</h3>                <div class="tg-selected-drop tg-date-fl">                    <span>日期</span>                    <p class="tg-drop-text-part"><i class="tg-graph tg-triangle-gray-bottom"></i><span class="hot-area" id="dc2"></span><input id="db2" type="hidden" value=""><input id="de2" type="hidden" value=""></p>                </div>                <div class="boxshadow luntan-hotword-2"></div>            </div>            <div class="blockpart  col-lg-12 col-md-12 col-sm-12 col-xs-12">                <h3>论坛话题排行榜</h3>                <div class="tg-selected-drop tg-date-fl">                    <span>日期</span>                    <p class="tg-drop-text-part"><i class="tg-graph tg-triangle-gray-bottom"></i><span class="hot-area" id="dc3"></span><input id="db3" type="hidden" value=""><input id="de3" type="hidden" value=""></p>                </div>                <div class="boxshadow rank-list-2"></div>            </div>',e+='<div class="blockpart  col-lg-12 col-md-12 col-sm-12 col-xs-12 channel-infor">',e+="<h3>论坛质量分析</h3>",e+='<div id="bs_quality"></div>',e+="</div>",e+='            <div class="more" id="bs_open_more">                <iframe src="" frameborder="0" id="IframePart" class="iframe-more-date" height="100%" width="100%" scrolling="no"></iframe>            </div>',$("#ct_main_area").addClass("channel-comment-part").html(e),M_Inside._downloadCsv(),B_Date._chooseSection({autoCommit:!0,todayValid:!1},1,M_Init._dateChoose.begin,M_Init._dateChoose.end,function(e,t){e==M_Init._dateCache.begin&&M_Init._dateCache.end==t||(M_Init._dateCache.begin=e,M_Init._dateCache.end=t,F_GameLight_Info._getEmotion())}),B_Date._chooseSection({autoCommit:!0,todayValid:!1},2,M_Init._dateChoose.begin,M_Init._dateChoose.end,function(e,t){e==M_Init._dateCache.begin2&&M_Init._dateCache.end2==t||(M_Init._dateCache.begin2=e,M_Init._dateCache.end2=t,F_GameLight_Info._getRank())}),B_Date._chooseSection({autoCommit:!0,todayValid:!1},3,M_Init._dateChoose.begin,M_Init._dateChoose.end,function(e,t){e==M_Init._dateCache.begin3&&M_Init._dateCache.end3==t||(M_Init._dateCache.begin3=e,M_Init._dateCache.end3=t,F_GameLight_Info._getTopicPort())}),B_Date._chooseSection({autoCommit:!0,todayValid:!1},5,M_Init._dateChoose.begin,M_Init._dateChoose.end,function(e,t){e==M_Init._dateCache.begin5&&M_Init._dateCache.end5==t||(M_Init._dateCache.begin5=e,M_Init._dateCache.end5=t,F_GameLight_Info._getTotal())}),B_Game._getCollect(function(){F_GameLight_Info._getInfo()}),setTimeout(function(){F_GameLight_Info._getQuality()},300)},_htmlTopic:function(e){for(var t='<ul class="left">',a=e.length,i=0;i<a&&!(i>9);i++)0==i?(M_Init._dateCache.hot_num_per_diff=Math.ceil(100/e[i].hot_num),e[i].hot_num=100):M_Init._dateCache.hot_num_per_diff&&(e[i].hot_num*=M_Init._dateCache.hot_num_per_diff),t+="<li>",t+="<div>",t+='<div class="rate-wrap"><span class="num">'+(i+1)+"</span>",t+='<span class="word-slice"><b>'+e[i].topic_id+"</b>",t+="</span>",t+='<div class="rate-content"><span class="rate" style="width: '+(100-e[i].hot_num)+'%"></span></div></div>',t+="</div>",t+='                    <div>                        <ul class="detail" data-t="'+e[i].topic_id+'">                            <li><span class="common-color" data-t="'+e[i].topic_id+'" data-c="100">'+e[i].post_num+'</span><p>全部帖子数</p></li>                            <li><span class="negtive-color" data-t="'+e[i].topic_id+'" data-c="-1">'+e[i].negative_num+'</span><p>负面情感帖数</p></li>                            <li><span class="positive-color" data-t="'+e[i].topic_id+'" data-c="1">'+e[i].positive_num+"</span><p>正面情感帖数</p></li>                        </ul>                    </div>",4==i&&a>5&&(t+='</ul><ul class="left">');return t+="</ul>"},_getTopicPort:function(){var e=$(".rank-list-2"),t={};t.start_date=M_Init._dateCache.begin3,t.end_date=M_Init._dateCache.end3,t.project_id=M_Init._gameDetailId,t.index=0,t.limit=10,t=B_Common._postData(t),B_Port._ajax("feedbackRank","get",!0,t,function(){e.html(B_Pre._loading())},function(){e.html("")},function(t,a){t&&t.topic_distri&&t.topic_distri.length>0?(e.html(F_GameLight_Info._htmlTopic(t.topic_distri)),$(".rank-list-2 .detail span").each(function(){$(this).click(function(){F_GameLight_Info._chartClick("rank_list_light",{topic:$(this).attr("data-t"),classify_sentiment:$(this).attr("data-c")})})})):e.html(B_Pre._empty("暂无数据"))},function(t,a,i){e.html(B_Pre._empty(a))})},_htmlRank:function(e,t){var a="";a+='<div class="left"><ul>';for(var i=0,n=1,_=0,s=!1,d="",o=0;o<e.length;o++)if("其他"!=e[o].word?(i=(parseInt(e[o].number)/t*100).toFixed(2),1==n?(_=(100/i).toFixed(0),i=100,a+='<li class="selected">',M_Init._dateCache.rankWord=e[o].word):(i*=_,a+="<li>"),a+="<span>"+e[o].word+'</span><div class="rate-wrap"><div class="rate" style="width: '+i+'%"></div></div></li>',n++):(d=e[o],s=!0),s){if(n>=10)break}else if(n>=11)break;return s&&(a+="<li><span>"+d.word+'</span><div class="rate-wrap"><div class="rate" style="width: '+i+'%"></div></div></li>'),a+="</ul></div>",a+='<div class="right"></div>'},_htmlRankDetail:function(){var e='<div class="top-slider top-slider-center">';if(e+='<div class="control prev-icon fl"><i></i></div>',e+='<div class="wrap" id="bs_rank_detail">',e+='<ul class="tab-click-change">',M_Init._dateCache.rankWordDetail&&M_Init._dateCache.rankWordDetail[M_Init._dateCache.rankWord])for(var t=M_Init._dateCache.rankWordDetail[M_Init._dateCache.rankWord],a=0,i=0;i<t.length;i++)a>10?a=10:a++,0==i?(e+='<li class="selected bg1">',M_Init._dateCache.rankWordCurrent=t[i].keyword):e+='<li class="bg'+a+'">',e+="<p>"+t[i].keyword+"</p></li>";e+="</ul></div>",e+='<div class="control next-icon fr"><i></i></div>',e+="</div>",e+='<div><div class="graph-part boxshadow"><div id="bs_rank_detail_chart_light" style="width: 100%;height: 100%"></div></div>',$(".luntan-hotword-2 .right").html(e),$(".tab-click-change").css("left","0");var n=110*$(".luntan-hotword-2 .right .top-slider .wrap ul li").length;$(".luntan-hotword-2 .right .top-slider .wrap ul").width(n),F_GameLight_Info._doRankTabChange(),F_GameLight_Info._getRankChart()},_getRank:function(){var e=$(".luntan-hotword-2"),t={};t.start_date=M_Init._dateCache.begin2,t.end_date=M_Init._dateCache.end2,t.project_id=M_Init._gameDetailId,t=B_Common._postData(t),B_Port._ajax("feedbackHotwords","get",!0,t,function(){e.html(B_Pre._loading())},function(){e.html("")},function(t,a){if(t&&t.length>0){for(var i=[],n={},_=0,s=0,d=0;d<t.length;d++)t[d].keywords&&(_=t[d].keywords.length)>0&&(s+=t[d].cnt,i.push({word:t[d].keyword_classify,number:t[d].cnt}),_>50&&(t[d].keywords=t[d].keywords.slice(0,50)),n[t[d].keyword_classify]=t[d].keywords);i&&i.length>0?(M_Init._dateCache.rankWordDetail=n,e.html(F_GameLight_Info._htmlRank(i,s)),F_GameLight_Info._doRankWordChange(),F_GameLight_Info._htmlRankDetail()):e.html(B_Pre._empty("暂无数据"))}else e.html(B_Pre._empty("暂无数据"))},function(t,a,i){e.html(B_Pre._empty(a))})},_getRankChart:function(){var e=$("#bs_rank_detail_chart_light"),t={};t.keyword=M_Init._dateCache.rankWordCurrent,t.start_date=M_Init._dateCache.begin2,t.end_date=M_Init._dateCache.end2,t.project_id=M_Init._gameDetailId,t=B_Common._postData(t),B_Port._ajax("feedbackKeywords","get",!0,t,function(){e.html(B_Pre._loading())},function(){e.html("")},function(t,a){if(t&&t.y_axis&&t.y_axis.length>0){var i={color:["#e38b4c"],x_axis:[],y_axis:[],xFormatDate:!0};i.x_axis=t.x_axis,i.y_axis.push({name:"热力指数",data:t.y_axis}),M_Outside_Chart._chartData("lineOpacity","bs_rank_detail_chart_light",i)}else e.html(B_Pre._empty("暂无数据"))},function(t,a,i){e.html(B_Pre._empty(a))})},_doRankWordChange:function(){$(".luntan-hotword-2 .left li").each(function(){$(this).click(function(){$(this).hasClass("selected")||($(this).addClass("selected").siblings("li").removeClass("selected"),M_Init._dateCache.rankWord=$(this).find("span").html(),F_GameLight_Info._htmlRankDetail())})})},_doRankTabChange:function(){$("#bs_rank_detail li").each(function(e){$(this).click(function(){$(this).hasClass("selected")||($(this).addClass("selected").siblings("li").removeClass("selected"),M_Init._dateCache.rankWordCurrent=$(this).find("p").html(),F_GameLight_Info._getRankChart())})})},_htmlForumBase:function(){var e="";return e+='        <div class="left">            <h5>玩家反馈情况概览</h5>            <div class="graph-part"><div id="bs_emotion_light" style="width: 100%; height: 100%"></div></div>            <div class="post-num-wrap" id="bs_tendency_left"></div>        </div>        <div class="mid negative-content" id="bs_tendency_mid"></div>        <div class="right" id="bs_tendency_right"></div>'},_htmlForumLeft:function(e){var t="";return t+='                <div class="graph-part cursor-default"><div id="bs_pie_light" style="width: 100%; height: 100%"></div></div>                <ul>                    <li class="selected">                        <div>                            <b class="negtive-color">'+e.neg+"%</b>                            <span>共"+e.negNum+'</span>                        </div>                        <p>论坛负面情感帖</p>                    </li>                    <li>                        <div>                            <b class="positive-color">'+e.pos+"%</b>                            <span>共"+e.posNum+'</span>                        </div>                        <p>论坛正面情感帖</p>                    </li>                    <li>                        <div>                            <b class="common-color">'+e.neutral+"%</b>                            <span>共"+e.neutralNum+"</span>                        </div>                        <p>论坛中性情感帖</p>                    </li>                </ul>"},_htmlForumMid:function(){var e="";return e+='            <ul class="tab-change">                <li class="red-bg">负面反馈</li>                <li>正面反馈</li>                <li>中性反馈</li>            </ul>            <ul class="tab-content boxshadow"></ul>'},_htmlForumRight:function(e){var t="";return t+='            <div class="t">                <h3>"'+e+'"反馈走势</h3>                <div class="graph-part"><div id="bs_word_tendency_light" style="width: 100%; height: 100%"></div></div>            </div>            <div class="b">                <h3>"'+e+'"反馈分布</h3>                <ul class="circle-union" id="bs_word_distribute_light"></ul>            </div>'},_getTendencyPort:function(){var e=$("#bs_tendency_left"),t=$("#bs_tendency_mid"),a=$("#bs_tendency_right"),i={};i.start_date=M_Init._dateCache.begin,i.end_date=M_Init._dateCache.end,i.project_id=M_Init._gameDetailId,i=B_Common._postData(i),B_Port._ajax("feedbackAnalyse","get",!0,i,function(){e.html(B_Pre._loading())},function(){e.html("")},function(i,n){if(i&&i.feedback_class_distri){var _={neg:0,negNum:0,pos:0,posNum:0,neutral:0,neutralNum:0,totalNum:0};_.neg=i.negative_rate?(100*i.negative_rate).toFixed(2):"0",_.negNum=i.negative_num?i.negative_num:"0",_.pos=i.positive_rate?(100*i.positive_rate).toFixed(2):"0",_.posNum=i.positive_num?i.positive_num:"0",_.neutral=i.other_rate?(100*i.other_rate).toFixed(2):"0",_.neutralNum=i.total_num?i.total_num-_.negNum-_.posNum:"0",_.totalNum=i.total_num?i.total_num:"0",M_Init._dateCache.tendencyNeg=[],M_Init._dateCache.tendencyPos=[],M_Init._dateCache.tendencyNeutral=[],$.each(i.feedback_class_distri,function(e,t){switch(e+""){case"0":M_Init._dateCache.tendencyNeutral=t;break;case"-1":M_Init._dateCache.tendencyNeg=t;break;case"1":M_Init._dateCache.tendencyPos=t}}),M_Init._dateCache.tendencyType=M_Init._dateCache.tendencyType?M_Init._dateCache.tendencyType:"tendencyNeg",e.html(F_GameLight_Info._htmlForumLeft(_));var s={name:"有情感倾向的帖子数",color:["#f78a97","#a8d87f","#84c0e9"],data:[{value:_.negNum,name:"论坛负面情感帖",selected:!0},{value:_.posNum,name:"论坛正面情感帖"},{value:_.neutralNum,name:"论坛中性情感帖"}],radius:["0%","70%"]};M_Outside_Chart._chartData("pie","bs_pie_light",s),t.html(F_GameLight_Info._htmlForumMid()),F_GameLight_Info._formatTendencyWord(),F_GameLight_Info._doTendencyTabChange("top"),F_GameLight_Info._doTendencyTabChange("left")}else e.html(B_Pre._empty("暂无数据")),t.html(B_Pre._empty("暂无数据")),a.html(B_Pre._empty("暂无数据"))},function(e,a,i){t.html(B_Pre._empty(a))})},_formatTendencyWord:function(){var e=M_Init._dateCache[M_Init._dateCache.tendencyType],t=!1,a="";if(e&&e.length>0){for(var i=1,n=0,_=0;_<e.length;_++)n+=parseInt(e[_].post_num);var s=0,d=0,o="rate",c=!1;switch(M_Init._dateCache.tendencyType){case"tendencyNeg":o="negtive-rate";for(var l={common:[],game:[]},_=0;_<e.length;_++)l[e[_].feedback_type].push(e[_]);l.common=e,M_Init._dateCache.tendencyNegType=M_Init._dateCache.tendencyNegType?M_Init._dateCache.tendencyNegType:"common",l.game.length>0&&(c=!0,a+='<div class="change-btn"><div>',a+="game"==M_Init._dateCache.tendencyNegType?'<input type="checkbox" id="bs_common_game" checked />':'<input type="checkbox" id="bs_common_game" />',a+=" </div><span> 仅显示产品相关</span></div>"),e=l[M_Init._dateCache.tendencyNegType];break;case"tendencyPos":o="positive-rate";break;case"tendencyNeutral":o="common-rate"}for(var _=0;_<e.length;_++)if("其它"!=e[_].lighttower_classify?(s=(parseInt(e[_].post_num)/n*100).toFixed(0),1==i?(M_Init._dateCache.tendencyWord=e[_].lighttower_classify,d=(100/s).toFixed(0),s=100,a+='<li class="selected">'):(s*=d,a+="<li>"),a+="<i>"+i+"</i>",a+="<b>"+e[_].lighttower_classify+"</b>",a+='<div class="rate-wrap">',a+='<div class="'+o+'" style="width:'+s+'%"></div>',a+="</div>",a+="</li>",i++):t=!0,t){if(i>=10)break}else if(i>=11)break;t&&(1==i?(M_Init._dateCache.tendencyWord="其它",a+='<li class="selected">'):a+="<li>",a+="<i>"+i+"</i>",a+="<b>其它</b>",a+='<div class="rate-wrap">',a+='<div class="'+o+'" style="width:'+s+'%"></div>',a+="</div></li>")}a?($("#bs_tendency_mid .tab-content").html(a),c&&($('input[type="checkbox"]').bootstrapSwitch("size","small"),$('input[type="checkbox"]').on("switchChange.bootstrapSwitch",function(e,t){M_Init._dateCache.tendencyNegType=t?"game":"common",F_GameLight_Info._formatTendencyWord()})),F_GameLight_Info._doTendencyWordChange(),F_GameLight_Info._getTendencyChart()):($("#bs_tendency_mid .tab-content").html(B_Pre._empty("暂无数据")),$("#bs_tendency_right").html(B_Pre._empty("暂无数据")))},_getTendencyChart:function(){var e=$("#bs_tendency_right"),t={x_axis:[],y_axis:[],xFormatDate:!0},a=[],i="";switch(M_Init._dateCache.classify_sentiment=0,M_Init._dateCache.tendencyType){case"tendencyNeg":t.color=["#f33f57"],M_Init._dateCache.classify_sentiment=-1,i="negtive-circle-union";break;case"tendencyPos":t.color=["#73bd36"],M_Init._dateCache.classify_sentiment=1,i="positive-circle-union";break;case"tendencyNeutral":t.color=["#1862c9"],M_Init._dateCache.classify_sentiment=0,i="common-circle-union"}if(!M_Init._dateCache.tendencyWord)return void e.html(B_Pre._empty("暂无数据"));var n={};n.start_date=M_Init._dateCache.begin,n.end_date=M_Init._dateCache.end,n.project_id=M_Init._gameDetailId,n.classify_sentiment=M_Init._dateCache.classify_sentiment,n.lighttower_classify=M_Init._dateCache.tendencyWord,n=B_Common._postData(n),B_Port._ajax("feedbackAnalyseDetail","get",!0,n,function(){e.html(B_Pre._loading())},function(){e.html("")},function(n,_){e.html(F_GameLight_Info._htmlForumRight(M_Init._dateCache.tendencyWord));var s=$("#bs_word_tendency_light"),d=$("#bs_word_distribute_light");if(n&&n.feedback_date_distri&&n.feedback_date_distri.length>0){t.x_axis=[],t.y_axis=[],a=[];for(var o=0;o<n.feedback_date_distri.length;o++)t.x_axis.push(n.feedback_date_distri[o].data_date),a.push(n.feedback_date_distri[o].post_num);t.y_axis.push({name:"帖子数",data:a}),M_Outside_Chart._chartData("lineOpacity","bs_word_tendency_light",t)}else s.html(B_Pre._empty("暂无数据"));if(M_Init._dateCache.feedback_tag_distri=[],n&&n.feedback_tag_distri&&n.feedback_tag_distri.length>0){M_Init._dateCache.feedback_tag_distri=n.feedback_tag_distri;for(var c="",o=0;o<n.feedback_tag_distri.length&&(c+='<li class="position-'+(o+1)+'" data-s="'+n.feedback_tag_distri[o].show_tag+'" data-r="'+n.feedback_tag_distri[o].real_tag+'"><b>'+(100*n.feedback_tag_distri[o].tag_rate).toFixed(2)+"%</b><p>"+n.feedback_tag_distri[o].show_tag+"</p></li>",!(o>=6));o++);d.addClass(i).html(c),d.find("li").each(function(){$(this).click(function(){F_GameLight_Info._chartClick("bs_word_distribute_light",{real:$(this).attr("data-r"),show:$(this).attr("data-s")})})})}else d.html(B_Pre._empty("暂无数据"))},function(t,a,i){e.html(B_Pre._empty(a))})},_doTendencyWordChange:function(){$("#bs_tendency_mid .tab-content li").each(function(){$(this).click(function(){$(this).hasClass("selected")||($(this).addClass("selected").siblings("li").removeClass("selected"),M_Init._dateCache.tendencyWord=$(this).find("b").html(),F_GameLight_Info._getTendencyChart())})})},_doTendencyTabChange:function(e){switch(e){case"left":$("#bs_tendency_left ul li").each(function(t){$(this).click(function(){$(this).hasClass("selected")||F_GameLight_Info._doTendencyTabChangeWork(e,$(this),t)})});break;case"top":$("#bs_tendency_mid .tab-change li").each(function(t){$(this).click(function(){$(this).hasClass("red-bg")||F_GameLight_Info._doTendencyTabChangeWork(e,$(this),t)})})}},_doTendencyTabChangeWork:function(e,t,a){switch(e){case"left":t.addClass("selected").siblings("li").removeClass("selected"),$("#bs_tendency_mid .tab-change li").eq(a).addClass("red-bg").siblings("li").removeClass("red-bg");break;case"top":t.addClass("red-bg").siblings("li").removeClass("red-bg"),$("#bs_tendency_left ul li").eq(a).addClass("selected").siblings("li").removeClass("selected")}switch(a+""){case"0":$("#bs_tendency_mid").removeClass("positive-content common-content").addClass("negative-content"),M_Init._dateCache.tendencyType="tendencyNeg";break;case"1":$("#bs_tendency_mid").removeClass("negative-content common-content").addClass("positive-content"),M_Init._dateCache.tendencyType="tendencyPos";break;case"2":$("#bs_tendency_mid").removeClass("positive-content negative-content").addClass("common-content"),M_Init._dateCache.tendencyType="tendencyNeutral"}F_GameLight_Info._formatTendencyWord()},_chartClick:function(e,t){var a=[];switch(a.push("g="+M_Init._gameDetailId),e){case"gameForumTotalLight":if(a.push("b="+B_Common._encodeUrl(t.date)),a.push("e="+B_Common._encodeUrl(t.date)),a.push("forum="+B_Common._encodeUrl(t.type)),M_Init._dataCache.gameForumTotalData)for(var i=M_Init._dataCache.gameForumTotalData,n=0;n<i.length;n++)if(i[n][t.type]){a.push("f="+i[n][t.type]);break}a.push("z=bbs");break;case"rank_list_light":a.push("b="+B_Common._encodeUrl(M_Init._dateCache.begin3)),a.push("e="+B_Common._encodeUrl(M_Init._dateCache.end3)),a.push("ts="+t.classify_sentiment),a.push("t="+B_Common._encodeUrl(t.topic)),a.push("z=bbs");break;case"bs_rank_detail_chart_light":a.push("b="+B_Common._encodeUrl(t.date)),a.push("e="+B_Common._encodeUrl(t.date)),a.push("w="+B_Common._encodeUrl(M_Init._dateCache.rankWordCurrent)),a.push("z=bbs");break;case"bs_word_distribute_light":a.push("b="+B_Common._encodeUrl(M_Init._dateCache.begin)),a.push("e="+B_Common._encodeUrl(M_Init._dateCache.end)),a.push("c="+B_Common._encodeUrl(M_Init._dateCache.tendencyWord)),a.push("s="+M_Init._dateCache.classify_sentiment),a.push("r="+B_Common._encodeUrl(t.real)),a.push("show="+B_Common._encodeUrl(t.show)),a.push("z=bbs");break;case"bs_word_tendency_light":a.push("b="+B_Common._encodeUrl(t.date)),a.push("e="+B_Common._encodeUrl(t.date)),a.push("c="+B_Common._encodeUrl(M_Init._dateCache.tendencyWord)),a.push("s="+M_Init._dateCache.classify_sentiment),a.push("z=bbs");break;case"bs_emotion_light":switch(t.type){case"正面反馈":a.push("s=1");break;case"负面反馈":a.push("s=-1")}a.push("b="+B_Common._encodeUrl(t.date)),a.push("e="+B_Common._encodeUrl(t.date)),a.push("z=bbs")}a&&(a=a.join("&")),M_Outside._openDetail(a)},_getEmotion:function(){$(".luntan-back-2").html(F_GameLight_Info._htmlForumBase());var e="";clearTimeout(e),e=setTimeout(function(){F_GameLight_Info._getEmotionPort()},600);var t="";clearTimeout(t),t=setTimeout(function(){F_GameLight_Info._getTendencyPort()},900)},_getEmotionPort:function(){var e=$("#bs_emotion_light"),t={};t.start_date=M_Init._dateCache.begin,t.end_date=M_Init._dateCache.end,t.project_id=M_Init._gameDetailId,t=B_Common._postData(t),B_Port._ajax("reputationIntroduceFeedback","get",!0,t,function(){e.html(B_Pre._loading())},function(){e.html("")},function(t,a){if(t&&t.length>0){for(var i={color:["#73bd36","#f33f57"],x_axis:[],y_axis:[],xFormatDate:!0,yFormat:"",legendSelectMode:!0,gridTop:"10%"},n=[],_=[],s=0;s<t.length;s++)i.x_axis.push(t[s].data_date),n.push(t[s].positive_num),_.push(t[s].negative_num);i.y_axis.push({name:"正面反馈",data:n}),i.y_axis.push({name:"负面反馈",data:_}),M_Outside_Chart._chartData("lineOpacity","bs_emotion_light",i)}else e.html(B_Pre._empty("暂无数据"))},function(t,a,i){e.html(B_Pre._empty(a))})},_htmlBase:function(e){var t="",a="";if(e.tag_list)for(var i=B_Game._tag(e.tag_list),n=0;n<e.tag_list.length;n++)i[e.tag_list[n]]&&(a+="<li onclick=\"M_Outside._redirectCenter('"+B_Common._encodeUrl(i[e.tag_list[n]])+"');\">"+i[e.tag_list[n]]+"</li>");var _="";return M_Game._gameInfo[4]&&(_=M_Game._gameInfo[4].split(","),_=_[0]),t+='            <div class="top">                <img src="'+M_Game._gameInfo[0]+'" alt="'+M_Game._gameInfo[1]+'">                <div class="des">                    <h3>'+M_Game._gameInfo[1]+"</h3>                    <ul>"+a+"</ul>                    <p>"+_+"类舆情量排名：<span>第<b>"+e.hot_rank+"</b>名<span></span></span></p>                    <span>开发商："+M_Game._gameInfo[2]+"</span>                    <span>发行商："+e.distributor+"</span>                    <span>发行日期："+e.release_date+'</span>                </div>            </div>            <div class="bottom">                <h4>游戏简介</h4>                <p>'+e.overview+"</p>            </div>"},_getInfo:function(){var e="";clearTimeout(e),e=setTimeout(function(){F_GameLight_Info._getInfoPort()},300)},_getInfoPort:function(){var e=$(".game-summary-2"),t=$("#bs_radar"),a=$("#bs_gauge"),i={};i.project_id=M_Init._gameDetailId,i=B_Common._postData(i),B_Port._ajax("reputationIntroduce","get",!0,i,function(){e.html(B_Pre._loading()),t.html(B_Pre._loading()),a.html(B_Pre._loading())},function(){e.html(""),t.html(""),a.html("")},function(t,a){t.game_info&&(e.html(F_GameLight_Info._htmlBase(t.game_info)),F_GameLight_Info._chartGauge(t.game_info.opinion_score),t.radar_data&&F_GameLight_Info._chartRadar(t.radar_data),$("#bs_add_game").click(function(){B_Game._checkCollect(M_Init._gameDetailId)?B_Pop._init("confirm",{skin:"layerCheck-class",content:"确实要取消添加【"+M_Game._gameInfo[1]+"】么？",btn:["确认","取消"],title:"操作提示"},function(){B_Pop._init("close"),B_Game._setCollect(M_Init._gameDetailId,"bs_add_game",{on:["tg-assist-btn","取消添加"],off:["tg-main-btn","添加游戏"]})},function(){B_Pop._init("close")}):B_Game._setCollect(M_Init._gameDetailId,"bs_add_game",{on:["tg-assist-btn","取消添加"],off:["tg-main-btn","添加游戏"]})}))},function(i,n,_){e.html(B_Pre._empty(n)),t.html(B_Pre._empty(n)),a.html(B_Pre._empty(n))})},_chartGauge:function(e){var t={gridTop:"25%",radius:"80%",detail:{formatter:"{value}"},data:[{value:e}],startAngle:210,endAngle:-30,name:"口碑评级",color:[[.4,"#5c3a77"],[.6,"#f7586a"],[.8,"#f49551"],[.9,"#f6d75a"],[1,"#33d184"]],pointerColor:"#436cbb",tooltipFormat:{formatter:"{a} : {c}"}};M_Outside_Chart._chartData("gauge","bs_gauge",t);var a="";e=parseInt(e),e<40?a='<b class="gray">待提高</b>':e>=40&&e<60?a='<b class="blue">中等</b>':e>=60&&e<80?a='<b class="yellow">良好</b>':e>=80&&e<90?a='<b class="red">优秀</b>':e>=90&&(a='<b class="purple">卓越</b>'),$("#bs_gauge_desc").html("<span>该游戏当前的口碑评级为："+a+"</span>")},_chartRadar:function(e){var t={"正向反馈占比":"negative_weight","讨论热度":"post_weight","舆情走势":"stable_weight","有效反馈占比":"useless_weight","活跃人数":"user_weight","畅销排名":"appstore_weight"},a={indicator:[],data:{"当前游戏":[]},legendSelectMode:!0,color:["#3daae3","#2ed383"]};$.each(t,function(t,i){"畅销排名"==t?e.avg[i]&&(a.indicator.push({text:t,max:100}),a.data["当前游戏"].push(e.real[i]?(100*e.real[i]).toFixed(0):0)):(a.indicator.push({text:t,max:100}),a.data["当前游戏"].push(e.real[i]?(100*e.real[i]).toFixed(0):0))}),a.indicator&&a.indicator.length>0&&$("#bs_radar").length>0&&M_Outside_Chart._chartData("radar","bs_radar",a)},_getTotal:function(){var e=$("#bs_chart_0_0"),t=$("#bs_table_list_0_0"),a={};a.start_date=M_Init._dateCache.begin5,a.end_date=M_Init._dateCache.end5,a.project_id=M_Init._gameDetailId,a=B_Common._postData(a),B_Port._ajax("forumAnalyse","get",!0,a,function(){e.html(B_Pre._loading()),t.html(B_Pre._loading()),$("#bs_page_0_0").html("")},function(){e.html(""),t.html("")},function(t,a){if(t&&t.y_axis){var i={head:["日期"],body:[]},n={x_axis:[],y_axis:[],xFormatDate:!0,legendSelectMode:!0,legendIsShow:!0};n.x_axis=t.x_axis,$.each(t.y_axis,function(e,t){i.head.push(e);for(var a=0;a<t.length;a++)i.body[a]||(i.body[a]=[n.x_axis[a]]),i.body[a].push(t[a]);n.y_axis.push({name:e,data:t})}),M_Outside_Chart._chartData("barSum","bs_chart_0_0",n,"gameForumTotalLight"),i.name="论坛帖子总量("+M_Init._dateCache.begin+"至"+M_Init._dateCache.end+")",M_Init._dataCache["0_0"]=i,M_Init._dataCache.gameForumTotalData=t.y_axis_desc,M_Inside._tableHtml(1,"0_0"),M_Inside._chartTableIcon("together",0,"0")}else e.html(B_Pre._empty("暂无数据"))},function(t,a,i){e.html(B_Pre._empty(a))})},_getQuality:function(){var e=$("#bs_quality"),t={};t.start_date=M_Init._dateCache.begin,t.end_date=M_Init._dateCache.end,t.project_id=M_Init._gameDetailId,t=B_Common._postData(t),B_Port._ajax("forumQualityAnalyse","get",!0,t,function(){e.html(B_Pre._loading())},function(){e.html("")},function(t,a){if(t&&t.useless_distri&&t.useless_distri.length>0){for(var i=t.useless_distri,n=[],_=0;_<i.length;_++)if(n[_]=[i[_].show_forum_name,i[_].forum_num.total,i[_].forum_num.positive,i[_].forum_num.negative,0,0,0,0,0,0],i[_].detail_classify_distri&&i[_].detail_classify_distri.length>0)for(var s="",d=0;d<i[_].detail_classify_distri.length;d++)switch(s=(100*i[_].detail_classify_distri[d].useless_rate).toFixed(2),i[_].detail_classify_distri[d].useless_classify){case"买卖":n[_][8]=s;break;case"灌水":n[_][5]=s;break;case"色情":n[_][6]=s;break;case"脏话":n[_][7]=s;break;case"广告":n[_][4]=s;break;case"其他":n[_][9]=s}e.html(F_GameLight_Info._htmlQuality(n))}else e.html(B_Pre._empty("暂无数据"))},function(t,a,i){e.html(B_Pre._empty(a))})},_htmlQuality:function(e){for(var t="",a=0;a<e.length;a++)t+='<div class="boxshadow">',t+='<div class="top-part">',t+="<p>"+e[a][0]+"</p>",t+="</div>",t+='<div class="rate-list"><ul>',t+="<li><span> 广告帖占比："+e[a][4]+'%</span><div class="rate"><div class="blue-rate" style="width: '+e[a][4]+'%"></div></div></li>',t+="<li><span> 灌水帖占比："+e[a][5]+'%</span><div class="rate"><div class="green-rate" style="width: '+e[a][5]+'%"></div></div></li>',t+="<li><span> 色情帖占比："+e[a][6]+'%</span><div class="rate"><div class="purple-rate" style="width: '+e[a][6]+'%"></div></div></li>',t+="<li><span> 脏话帖占比："+e[a][7]+'%</span><div class="rate"><div class="yellow-rate" style="width: '+e[a][7]+'%"></div></div></li>',t+="<li><span> 买卖帖占比："+e[a][8]+'%</span><div class="rate"><div class="blue1-rate" style="width: '+e[a][8]+'%"></div></div></li>',t+="</ul></div></div>";return t}};