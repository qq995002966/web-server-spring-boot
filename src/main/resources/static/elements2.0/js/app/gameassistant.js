var F_GameAssistant_Entrance={_init:function(t){if(B_Login._checkUpdate(),M_HeadFoot._headShow(2),M_Dom._menuList("游戏详情","7-10"),B_User._isDemoUser())B_Login._openLogin("background");else{M_Init._clean();var a=B_Common._getUrl("query");a.g?(M_Init._gameDetailId=a.g,B_Game._setLast(M_Init._gameDetailId,"outsideGameDetail")):t?(M_Init._gameDetailId=t,B_Game._setLast(M_Init._gameDetailId,"outsideGameDetail")):M_Init._gameDetailId||(M_Init._gameDetailId=M_Init._getGameId("outsideGameDetail")),M_Game._checkGameVisitList("gameAssistant")}}},F_GameAssistant_Info={_chartClick:function(t,a){var e=[];switch(t){case"bs_hotword_tread_light":e.push("g="+M_Init._gameDetailId),e.push("b="+B_Common._encodeUrl(a.date)),e.push("e="+B_Common._encodeUrl(a.date)),e.push("w="+B_Common._encodeUrl(a.name)),e.push("z=bbs");break;case"bs_suddenly_chart":var n=$.inArray(a.classify,M_Outside._alarmInit.type);if(n>-1){var i=M_Outside._alarmInit.typeId[n];if(M_Init._dataCache.alarmData&&M_Init._dataCache.alarmData[i])for(var o=M_Init._dataCache.alarmData[i],_=0;_<o.length;_++)if(a.date==o[_].data_date){e.push("g="+M_Init._gameDetailId),e.push("d="+B_Common._encodeUrl(o[_].data_date)),e.push("p="+B_Common._encodeUrl(o[_].sub_type)),e.push("s_n="+B_Common._encodeUrl(a.classify));break}}if(!(e&&e.length>0))return B_Pop._init("msg",{content:"查询参数错误，请刷新页面重试"}),!1;e.push("z=suddenly")}e&&(e=e.join("&")),M_Outside._openDetail(e)},_domInit:function(){var t="";t+='<div class="blockpart col-lg-12 col-md-12 col-sm-12 col-xs-12">',t+="<h3>舆情突发问题监测</h3>",t+='<div class="boxshadow"><div class="suddenly-graph"><div id="bs_suddenly_chart" style="width: 100%; height: 100%"></div></div></div>',t+="</div>",t+='<div class="blockpart col-lg-12 col-md-12 col-sm-12 col-xs-12">',t+='<h3 class="part-title">热词走势追踪</h3>',t+='<div class="boxshadow">',t+='<div class="tg-filter-show">',t+='<ul class="hot-filter-list">',t+="<p>选择监测日期</p>",t+='<p class="tg-drop-text-part"><i class="tg-graph tg-triangle-gray-bottom"></i><span class="hot-area" id="dc1"></span><input id="db1" type="hidden" value=""><input id="de1" type="hidden" value=""></p>',t+="<p>选择监测热词</p>",t+="</ul>",t+='<ul class="hotword-graph-show">',t+='<div id="bs_hotword_tread_light" class="b_chart"></div>',t+="</ul>",t+="</div></div>",t+="</div>",t+='<div class="more" id="bs_open_more">                    <iframe src="" frameborder="0" id="IframePart" class="iframe-more-date" height="100%" width="100%" scrolling="no"></iframe>                </div>',$("#ct_main_area").html(t),F_GameAssistant_Info._getAlarmInfo(),B_Date._chooseSection({autoCommit:!0,todayValid:!1},1,M_Init._dateChoose.begin,M_Init._dateChoose.end,function(t,a){t==M_Init._dateCache.begin&&M_Init._dateCache.end==a||(M_Init._dateCache.begin=t,M_Init._dateCache.end=a,F_GameAssistant_Info._getWordInfo())})},_getAlarmInfo:function(){var t=$("#bs_suddenly_chart"),a={};a.project_id=M_Init._gameDetailId,a=B_Common._postData(a),B_Port._ajax("sigmaItWarn","get",!0,a,function(){t.html(B_Pre._loading())},function(){t.html()},function(t,a){if(t&&t.develop){M_Init._dataCache.alarmData=t;var e={xAxis:[],series:{}},n=1;$.each(t,function(t,a){var i="",o=$.inArray(t,M_Outside._alarmInit.typeId);o>-1&&(i=M_Outside._alarmInit.type[o]),e.series[i]=[];for(var _=0;_<a.length;_++)1==n&&e.xAxis.push(a[_].data_date),a[_].warn_level>6&&(a[_].warn_level=6),e.series[i].push(a[_].warn_level);n++}),F_GameAssistant_Info._chartInfo(e)}},function(a,e,n){t.html(B_Pre._empty(e))})},_chartInfo:function(t){if(t&&t.xAxis){var a={series:[]};t.legend=[],$.each(t.series,function(e,n){t.legend.push({name:e,icon:"roundRect"}),a.series.push({lineStyle:{normal:{width:2}},smooth:!0,name:e,type:"line",data:n})}),a.tooltip={trigger:"axis"},a.legend={left:"right",data:t.legend},a.grid={left:"30",right:"30",bottom:0,top:"6%",containLabel:!0},a.xAxis=[{splitLine:{show:!1},type:"category",data:t.xAxis,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{textStyle:{color:"#333333",fontSize:"11px"},formatter:function(t,a){return B_Date._hourChart(t)}}}],a.yAxis=[{splitLine:{lineStyle:{color:"#EEEEEE"}},name:null,type:"value",axisLine:{show:!1},axisTick:{show:!1},axisLabel:{textStyle:{color:"#333333",fontSize:"11px"},formatter:function(t,a){var e=a>0?6==a?"高危预警":M_Outside._alarmInit.power[a]:"";return e}},min:0,max:6}],B_Chart._getEChart("line","bs_suddenly_chart",a,"gameAssistantAlarm")}},_getWordInfo:function(){var t=$("#bs_hotword_tread_light"),a={};a.data_date_start=M_Init._dateCache.begin,a.data_date_end=M_Init._dateCache.end,a.project_id=M_Init._gameDetailId,a=B_Common._postData(a),B_Port._ajax("hotWordTrend","get",!0,a,function(){t.html(B_Pre._loading())},function(){t.html("")},function(t,a){if(t){var e={word:{},x_axis:[],y_axis:[],xFormatDate:!0,legendSelectMode:!0},n=B_Date._dateArray(M_Init._dateCache.begin,M_Init._dateCache.end);$.each(t,function(t,a){if(e.word[t]={date:[],number:[]},a)for(var n=0;n<a.length;n++){var i=B_Date._dateFormat("base",a[n][0]);e.word[t].date.push(i),e.word[t].number.push(a[n][1])}});var i=0,o=[];M_Init._dataCache.word=[],$.each(e.word,function(t,a){o=[],M_Init._dataCache.word.push(t),$.each(n,function(t,n){0==i&&e.x_axis.push(n.big);var _=$.inArray(n.big,a.date);_>-1?o.push(a.number[_]):o.push(0)}),e.y_axis.push({name:t,data:o}),i++}),M_Outside_Chart._chartData("line","bs_hotword_tread_light",e),M_Init._dataCache.wordHasAppend||(M_Init._dataCache.wordHasAppend=!0,$(".hot-filter-list").append(F_GameAssistant_Info._htmlWords()),F_GameAssistant_Info._btnClickChangeWord())}},function(a,e,n){t.html(B_Pre._empty(e))})},_btnClickChangeWord:function(){$(".hot-filter-list .tg-main-btn").click(function(){var t=[],a=!1;if($('input[name="word"]').each(function(){var e=$.trim($(this).val());""!=e&&(e.length>6&&(a=!0),e=B_Format._blankRemove(e),t.push(e))}),a)return B_Pop._init("msg",{content:"请输入不多于6个字的热词"}),!1;if(0==t.length)return B_Pop._init("msg",{content:"监控热词不能为空"}),!1;var e=!1;if(M_Init._dataCache.word.length==t.length)for(var n=0;n<t.length;n++)$.inArray(t[n],M_Init._dataCache.word)>-1||(e=!0);else e=!0;if(!e)return B_Pop._init("msg",{content:"请修改监控热词"}),!1;var t=t.join(" "),i={};i.custom_keywords=t,i.project_id=M_Init._gameDetailId,i=B_Common._postData(i),F_GameAssistant_Info._doWordUpdate(i)})},_doWordUpdate:function(t){var a=$(".hot-filter-list .tg-main-btn");B_Port._ajax("insertCustomKeywords","post",!0,t,function(){B_Common._btnTextStatus("disable",a,{disable:"修改中..."})},function(){B_Common._btnTextStatus("normal",a,{normal:"修改"})},function(t,a){B_Pop._init("msg",{content:"修改成功"}),setTimeout(function(){F_GameAssistant_Info._getWordInfo()},1e3)},function(t,a,e){B_Pop._init("msg",{content:B_Pre._empty(a)})})},_htmlWords:function(){for(var t="",a=0;a<5;a++){var e=M_Init._dataCache.word[a]?M_Init._dataCache.word[a]:"";t+='<li><input class="tg-input" type="text" name="word" placeholder="热词'+(a+1)+'" maxlength="20" value="'+e+'"></li>'}return t+='<li><a class="tg-main-btn">修改</a></li>'}};