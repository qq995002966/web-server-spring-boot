requirejs.config({shim:{layer:["jquery"],"store.min":["jquery"],background:{deps:["base"]}},baseUrl:"elements2.0/js/lib",paths:{jquery:"./jquery-1.9.1.min",app:"../app",base:"../app/base",background:"../app/background"}}),require(["jquery","layer","store.min","base","background","app/inside"],function(){if(store=require("store.min"),B_Login._checkUpdate(),B_User._isDemoUser())parent.B_Login._openLogin("background");else{var t=B_Common._getUrl("query");if(!t.g||isNaN(t.g))return parent.B_Pop._init("close"),parent.B_Pop._init("msg",{content:"选择的数据不存在，请刷新页面重试"}),!1;var a="",e="",n="开发,活动,版本",i=3,r=1;parent.F_Alarm_Info._cache.mailData&&(a=parent.F_Alarm_Info._cache.mailData.task_name,e=parent.F_Alarm_Info._cache.mailData.email_addr,n=parent.F_Alarm_Info._cache.mailData.lt_warn_class,i=parent.F_Alarm_Info._cache.mailData.warn_level,r=parent.F_Alarm_Info._cache.mailData.status,i>5&&(i=5)),$(".tg-assist-btn").click(function(){parent.B_Pop._init("close")}),$('input[name="email_title"]').val(a),$('input[name="email_addr"]').val(e);var o='<div class="checkbox-wrap">';n=n?n.split(","):[];for(var _=0;_<parent.F_Alarm_Common._init.type.length;_++)o+='<div class="tg-checkbox-btn"><input type="checkbox" id="c'+_+'" name="type"',o+=$.inArray(parent.F_Alarm_Common._init.type[_]+"",n)>-1?" checked ":"",o+='value="'+parent.F_Alarm_Common._init.type[_]+'"><label for="c'+_+'">'+parent.F_Alarm_Common._init.type[_]+"类预警</label></div>";o+="</div>",$(".pop-list li").eq(0).append(o),o="",o+='<div class="tg-selected-drop"><p class="tg-drop-text-part"><i class="tg-graph tg-triangle-gray-bottom"></i><span data-i="'+i+'">'+parent.F_Alarm_Common._init.power[i]+"</span></p>",o+='<ul style="display: none;">';for(var _=1;_<parent.F_Alarm_Common._init.power.length;_++)o+='<li><a data-i="'+_+'">'+parent.F_Alarm_Common._init.power[_]+"</a></li>";o+="</ul></div>",$(".tg-selected-drop").html(o),M_Inside._dropShow(),M_Inside._dropSelected(),M_Inside._dropLeave(),$(".dropdown-menu li a").each(function(){$(this).click(function(){$(".dropdown-toggle span").attr("data-t",$(this).attr("data-t")).text($(this).text())})}),$('input[name="status"]').each(function(){$(this).val()==r+""?$(this).attr("checked",!0):$(this).attr("checked",!1)}),$(".tg-main-btn").click(function(){var a=$.trim($('input[name="email_title"]').val()),e=$.trim($('input[name="email_addr"]').val()),n=[],i=$.trim($(".tg-selected-drop span").attr("data-i")),r=B_Common._getCheckboxVal("type"),o=B_Common._getRadioVal("status");if(""==r)return B_Pop._init("msg",{content:"请选择预警类型"}),!1;if(""==a)return B_Pop._init("msg",{content:"请填写任务名称"}),!1;if(""==e)return B_Pop._init("msg",{content:"请填写接收邮箱"}),!1;var _=!1;e=e.split(" ");for(var l=0;l<e.length;l++)""!=e[l]&&(B_Common._isMail(e[l])?n.push(e[l]):_=!0);if(_)return B_Pop._init("msg",{content:"请填写合法的接收邮箱"}),!1;n=e.join(" ");var m={};m.email_addr=n,m.task_name=a,m.status=o,m.lt_warn_class=r,m.warn_level=i,m.project_id=t.g,m=B_Common._postData(m),B_Port._ajax("sigmaItWarnMailSet","post",!0,m,function(){B_Common._btnTextStatus("disable",$(".tg-main-btn"),{disable:"提交中..."})},function(){B_Common._btnTextStatus("normal",$(".tg-main-btn"),{normal:"确认提交"})},function(t,a){return B_Pop._init("msg",{content:"设置成功"}),parent.F_Alarm_Info._getMail(),setTimeout(function(){parent.B_Pop._init("close")},1e3),!1},function(t,a,e){return B_Pop._init("msg",{content:a}),!1})})}});